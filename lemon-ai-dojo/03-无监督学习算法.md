# 无监督学习算法

## 💡 核心结论

1. **K-means通过迭代优化聚类中心，需要预先指定K值**
2. **层次聚类不需要预设K值，生成树状图**
3. **PCA通过特征值分解降维，保留最大方差**
4. **t-SNE适合高维数据可视化，但计算量大**
5. **异常检测可用Isolation Forest或One-Class SVM**

---

## 1. 聚类算法

### 1.1 K-means

```python
from sklearn.cluster import KMeans
import numpy as np
import matplotlib.pyplot as plt

# 数据
X = np.random.randn(300, 2)

# 训练
kmeans = KMeans(n_clusters=3, random_state=42)
labels = kmeans.fit_predict(X)

# 聚类中心
centers = kmeans.cluster_centers_

# 可视化
plt.scatter(X[:, 0], X[:, 1], c=labels, cmap='viridis')
plt.scatter(centers[:, 0], centers[:, 1], c='red', marker='x', s=200)
plt.title('K-means聚类')
plt.show()

# 肘部法则选择K值
inertias = []
K_range = range(1, 11)
for k in K_range:
    kmeans = KMeans(n_clusters=k, random_state=42)
    kmeans.fit(X)
    inertias.append(kmeans.inertia_)

plt.plot(K_range, inertias, 'bo-')
plt.xlabel('K值')
plt.ylabel('惯性')
plt.title('肘部法则')
plt.show()
```

### 1.2 层次聚类

```python
from sklearn.cluster import AgglomerativeClustering
from scipy.cluster.hierarchy import dendrogram, linkage

# 训练
model = AgglomerativeClustering(n_clusters=3, linkage='ward')
labels = model.fit_predict(X)

# 树状图
linkage_matrix = linkage(X, method='ward')
plt.figure(figsize=(10, 7))
dendrogram(linkage_matrix)
plt.title('层次聚类树状图')
plt.show()
```

### 1.3 DBSCAN

```python
from sklearn.cluster import DBSCAN

# 基于密度的聚类
model = DBSCAN(eps=0.5, min_samples=5)
labels = model.fit_predict(X)

# -1表示噪声点
n_clusters = len(set(labels)) - (1 if -1 in labels else 0)
n_noise = list(labels).count(-1)

print(f"聚类数: {n_clusters}")
print(f"噪声点: {n_noise}")
```

---

## 2. 降维算法

### 2.1 PCA（主成分分析）

```python
from sklearn.decomposition import PCA

# 降到2维
pca = PCA(n_components=2)
X_reduced = pca.fit_transform(X)

# 方差解释率
print(f"方差解释率: {pca.explained_variance_ratio_}")
print(f"累计方差: {pca.explained_variance_ratio_.cumsum()}")

# 自动选择维度（保留95%方差）
pca = PCA(n_components=0.95)
X_reduced = pca.fit_transform(X)
print(f"降维后维度: {X_reduced.shape[1]}")
```

### 2.2 t-SNE

```python
from sklearn.manifold import TSNE

# 降到2维可视化
tsne = TSNE(n_components=2, random_state=42)
X_embedded = tsne.fit_transform(X)

plt.scatter(X_embedded[:, 0], X_embedded[:, 1], c=y, cmap='viridis')
plt.title('t-SNE可视化')
plt.show()
```

---

## 3. 异常检测

```python
from sklearn.ensemble import IsolationForest

# 训练
model = IsolationForest(contamination=0.1, random_state=42)
predictions = model.fit_predict(X)

# -1表示异常，1表示正常
anomalies = X[predictions == -1]
normal = X[predictions == 1]

plt.scatter(normal[:, 0], normal[:, 1], c='blue', label='正常')
plt.scatter(anomalies[:, 0], anomalies[:, 1], c='red', label='异常')
plt.legend()
plt.show()
```

---

## 参考资源

- Scikit-learn Clustering
- 《Pattern Recognition and Machine Learning》

