# è®¡ç®—æœºè§†è§‰åº”ç”¨

## ğŸ’¡ æ ¸å¿ƒç»“è®º

1. **å›¾åƒåˆ†ç±»æ˜¯è®¡ç®—æœºè§†è§‰çš„åŸºç¡€ä»»åŠ¡**
2. **ç›®æ ‡æ£€æµ‹å®šä½ç‰©ä½“ä½ç½®ï¼ŒYOLOç³»åˆ—é€Ÿåº¦å¿«**
3. **è¯­ä¹‰åˆ†å‰²é€åƒç´ åˆ†ç±»ï¼ŒU-Netæ˜¯ç»å…¸æ¶æ„**
4. **è¿ç§»å­¦ä¹ å¯ä»¥ç”¨é¢„è®­ç»ƒæ¨¡å‹å¿«é€Ÿè§£å†³æ–°ä»»åŠ¡**
5. **æ•°æ®å¢å¼ºæ˜¯æå‡æ¨¡å‹æ€§èƒ½çš„å…³é”®**

---

## 1. å›¾åƒåˆ†ç±»

### 1.1 ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹

```python
import torch
import torchvision.models as models
from torchvision import transforms
from PIL import Image

# åŠ è½½é¢„è®­ç»ƒæ¨¡å‹
model = models.resnet50(pretrained=True)
model.eval()

# å›¾åƒé¢„å¤„ç†
transform = transforms.Compose([
    transforms.Resize(256),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(
        mean=[0.485, 0.456, 0.406],
        std=[0.229, 0.224, 0.225]
    )
])

# é¢„æµ‹
image = Image.open('image.jpg')
input_tensor = transform(image).unsqueeze(0)

with torch.no_grad():
    output = model(input_tensor)
    probabilities = torch.softmax(output[0], dim=0)
    top5_prob, top5_catid = torch.topk(probabilities, 5)

# åŠ è½½ImageNetæ ‡ç­¾
with open('imagenet_classes.txt') as f:
    categories = [s.strip() for s in f.readlines()]

for i in range(5):
    print(f"{categories[top5_catid[i]]}: {top5_prob[i].item():.2%}")
```

### 1.2 è¿ç§»å­¦ä¹ 

```python
# å†»ç»“é¢„è®­ç»ƒå±‚ï¼Œåªè®­ç»ƒæœ€åçš„åˆ†ç±»å±‚
model = models.resnet50(pretrained=True)

# å†»ç»“æ‰€æœ‰å±‚
for param in model.parameters():
    param.requires_grad = False

# æ›¿æ¢æœ€åçš„å…¨è¿æ¥å±‚
num_classes = 10
model.fc = torch.nn.Linear(model.fc.in_features, num_classes)

# åªè®­ç»ƒæ–°çš„åˆ†ç±»å±‚
optimizer = torch.optim.Adam(model.fc.parameters(), lr=0.001)
```

---

## 2. ç›®æ ‡æ£€æµ‹

### 2.1 YOLO

```python
import cv2
from ultralytics import YOLO

# åŠ è½½æ¨¡å‹
model = YOLO('yolov8n.pt')

# é¢„æµ‹
image = cv2.imread('image.jpg')
results = model(image)

# è§£æç»“æœ
for result in results:
    boxes = result.boxes
    for box in boxes:
        x1, y1, x2, y2 = box.xyxy[0]
        confidence = box.conf[0]
        class_id = box.cls[0]
        
        # ç»˜åˆ¶è¾¹ç•Œæ¡†
        cv2.rectangle(image, (int(x1), int(y1)), (int(x2), int(y2)), (0, 255, 0), 2)
        cv2.putText(image, f'{model.names[int(class_id)]} {confidence:.2f}',
                   (int(x1), int(y1)-10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)

cv2.imshow('Detection', image)
cv2.waitKey(0)
```

---

## 3. è¯­ä¹‰åˆ†å‰²

```python
from torchvision.models.segmentation import deeplabv3_resnet50

# åŠ è½½æ¨¡å‹
model = deeplabv3_resnet50(pretrained=True)
model.eval()

# é¢„æµ‹
input_tensor = transform(image).unsqueeze(0)

with torch.no_grad():
    output = model(input_tensor)['out'][0]
    output_predictions = output.argmax(0)

# å¯è§†åŒ–
import matplotlib.pyplot as plt

plt.imshow(output_predictions)
plt.show()
```

---

## 4. æ•°æ®å¢å¼º

```python
from torchvision import transforms

# è®­ç»ƒæ—¶å¢å¼º
train_transform = transforms.Compose([
    transforms.RandomResizedCrop(224),
    transforms.RandomHorizontalFlip(),
    transforms.RandomRotation(15),
    transforms.ColorJitter(brightness=0.2, contrast=0.2),
    transforms.ToTensor(),
    transforms.Normalize([0.485, 0.456, 0.406], [0.229, 0.224, 0.225])
])

# æµ‹è¯•æ—¶ä¸å¢å¼º
test_transform = transforms.Compose([
    transforms.Resize(256),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize([0.485, 0.456, 0.406], [0.229, 0.224, 0.225])
])
```

---

## å‚è€ƒèµ„æº

- PyTorch Visionåº“
- YOLOå®˜æ–¹æ–‡æ¡£
- Papers With Code

