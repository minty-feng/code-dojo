# 03-面向对象编程基础

## 类和对象

### 类定义
```cpp
class Person {
private:
    string name;
    int age;
    
public:
    // 构造函数
    Person(string n, int a) : name(n), age(a) {}
    
    // 成员函数
    void display() {
        cout << "Name: " << name << ", Age: " << age << endl;
    }
    
    // 访问器
    string getName() const { return name; }
    int getAge() const { return age; }
    
    // 修改器
    void setName(const string& n) { name = n; }
    void setAge(int a) { age = a; }
};
```

### 对象创建和使用
```cpp
Person p1("Alice", 25);          // 栈上创建
Person* p2 = new Person("Bob", 30); // 堆上创建
p1.display();                    // 调用成员函数
delete p2;                       // 释放堆内存
```

### 访问控制
- **public**：公开访问
- **private**：私有访问（默认）
- **protected**：受保护访问

## 构造函数和析构函数

### 构造函数
```cpp
class Rectangle {
private:
    int width, height;
    
public:
    // 默认构造函数
    Rectangle() : width(0), height(0) {}
    
    // 参数化构造函数
    Rectangle(int w, int h) : width(w), height(h) {}
    
    // 拷贝构造函数
    Rectangle(const Rectangle& other) 
        : width(other.width), height(other.height) {}
    
    // 移动构造函数（C++11）
    Rectangle(Rectangle&& other) noexcept
        : width(other.width), height(other.height) {
        other.width = other.height = 0;
    }
};
```

### 析构函数
```cpp
class Resource {
private:
    int* data;
    
public:
    Resource(int size) : data(new int[size]) {}
    
    // 析构函数
    ~Resource() {
        delete[] data;
    }
};
```

### 初始化列表
```cpp
class Student {
private:
    string name;
    int id;
    const int grade;
    
public:
    // 初始化列表
    Student(string n, int i, int g) 
        : name(n), id(i), grade(g) {}
};
```

## 继承

### 单继承
```cpp
// 基类
class Animal {
protected:
    string species;
    
public:
    Animal(string s) : species(s) {}
    virtual void makeSound() {
        cout << "Animal sound" << endl;
    }
    virtual ~Animal() = default;
};

// 派生类
class Dog : public Animal {
public:
    Dog() : Animal("Canine") {}
    
    void makeSound() override {
        cout << "Woof!" << endl;
    }
};
```

### 访问修饰符
- **public继承**：保持原有访问级别
- **protected继承**：public变为protected
- **private继承**：所有成员变为private

### 多重继承
```cpp
class Flyable {
public:
    virtual void fly() = 0;
};

class Swimmable {
public:
    virtual void swim() = 0;
};

class Duck : public Animal, public Flyable, public Swimmable {
public:
    void fly() override {
        cout << "Duck flying" << endl;
    }
    
    void swim() override {
        cout << "Duck swimming" << endl;
    }
};
```

## 多态

### 虚函数
```cpp
class Shape {
public:
    virtual double area() const = 0;  // 纯虚函数
    virtual void draw() const {
        cout << "Drawing shape" << endl;
    }
    virtual ~Shape() = default;
};

class Circle : public Shape {
private:
    double radius;
    
public:
    Circle(double r) : radius(r) {}
    
    double area() const override {
        return 3.14159 * radius * radius;
    }
    
    void draw() const override {
        cout << "Drawing circle" << endl;
    }
};
```

### 虚函数表
- **vtable**：存储虚函数地址的表
- **vptr**：指向虚函数表的指针
- **动态绑定**：运行时确定调用哪个函数

### 抽象类
```cpp
class AbstractShape {
public:
    virtual double area() const = 0;  // 纯虚函数
    virtual double perimeter() const = 0;  // 纯虚函数
    
    // 可以有非虚函数
    void printInfo() {
        cout << "Area: " << area() << endl;
        cout << "Perimeter: " << perimeter() << endl;
    }
};
```

## 封装

### 数据封装
```cpp
class BankAccount {
private:
    double balance;
    string accountNumber;
    
public:
    BankAccount(string accNum, double initialBalance) 
        : accountNumber(accNum), balance(initialBalance) {}
    
    // 公共接口
    void deposit(double amount) {
        if (amount > 0) {
            balance += amount;
        }
    }
    
    bool withdraw(double amount) {
        if (amount > 0 && amount <= balance) {
            balance -= amount;
            return true;
        }
        return false;
    }
    
    double getBalance() const {
        return balance;
    }
};
```

### 友元函数和友元类
```cpp
class Rectangle {
private:
    int width, height;
    
public:
    Rectangle(int w, int h) : width(w), height(h) {}
    
    // 友元函数
    friend void printDimensions(const Rectangle& r);
    
    // 友元类
    friend class RectangleHelper;
};

void printDimensions(const Rectangle& r) {
    cout << "Width: " << r.width << ", Height: " << r.height << endl;
}
```

## 运算符重载

### 基本运算符重载
```cpp
class Vector {
private:
    double x, y;
    
public:
    Vector(double x = 0, double y = 0) : x(x), y(y) {}
    
    // 加法运算符
    Vector operator+(const Vector& other) const {
        return Vector(x + other.x, y + other.y);
    }
    
    // 赋值运算符
    Vector& operator=(const Vector& other) {
        if (this != &other) {
            x = other.x;
            y = other.y;
        }
        return *this;
    }
    
    // 输出运算符（友元函数）
    friend ostream& operator<<(ostream& os, const Vector& v) {
        os << "(" << v.x << ", " << v.y << ")";
        return os;
    }
};
```

### 特殊运算符
```cpp
class Array {
private:
    int* data;
    int size;
    
public:
    // 下标运算符
    int& operator[](int index) {
        return data[index];
    }
    
    const int& operator[](int index) const {
        return data[index];
    }
    
    // 函数调用运算符
    int operator()(int index) const {
        return data[index];
    }
};
```

## 静态成员

### 静态数据成员
```cpp
class Counter {
private:
    static int count;  // 静态数据成员
    
public:
    Counter() { count++; }
    ~Counter() { count--; }
    
    static int getCount() {  // 静态成员函数
        return count;
    }
};

int Counter::count = 0;  // 静态成员定义
```

### 静态成员函数
- 属于类而不是对象
- 不能访问非静态成员
- 可以通过类名直接调用
- 没有this指针
