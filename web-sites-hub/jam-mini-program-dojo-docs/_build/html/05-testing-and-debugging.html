

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æµ‹è¯•ä¸è°ƒè¯• &mdash; Mini Program Tutorial 1.0.0 æ–‡æ¡£</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=d25bc049" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=34088549"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/translations.js?v=beaddf03"></script>
      <script src="_static/copy-code.js?v=37526288"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="ç´¢å¼•" href="genindex.html" />
    <link rel="search" title="æœç´¢" href="search.html" />
    <link rel="next" title="åç«¯å¼€å‘ä¸é›†æˆ" href="06-backend-development.html" />
    <link rel="prev" title="éƒ¨ç½²ä¸å‘å¸ƒ" href="04-deployment-and-release.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #07c160" >

          
          
          <a href="index.html" class="icon icon-home">
            Mini Program Tutorial
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="æœç´¢æ–‡æ¡£" aria-label="æœç´¢æ–‡æ¡£" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="å¯¼èˆªèœå•">
              <p class="caption" role="heading"><span class="caption-text">ç›®å½•</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">WeChat Mini Program Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-wechat-miniprogram-basics.html">åŸºç¡€</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-network-request-and-cloud.html">ç½‘ç»œè¯·æ±‚ä¸äº‘å¼€å‘</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-performance-optimization.html">æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-deployment-and-release.html">éƒ¨ç½²ä¸å‘å¸ƒ</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">æµ‹è¯•ä¸è°ƒè¯•</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">ğŸ’¡ æ ¸å¿ƒç»“è®º</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">1. å¼€å‘è€…å·¥å…·è°ƒè¯•</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">1.1 è°ƒè¯•å™¨ä½¿ç”¨</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">1.2 æ€§èƒ½åˆ†æ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">1.3 å­˜å‚¨é¢æ¿</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id7">2. çœŸæœºè°ƒè¯•</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">2.1 é¢„è§ˆåŠŸèƒ½</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">2.2 çœŸæœºè°ƒè¯•</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">2.3 è¿œç¨‹è°ƒè¯•</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">2.4 å¸¸è§çœŸæœºé—®é¢˜</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id12">3. å•å…ƒæµ‹è¯•</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id13">3.1 æµ‹è¯•æ¡†æ¶é…ç½®</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">3.2 å·¥å…·å‡½æ•°æµ‹è¯•</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api">3.3 APIæµ‹è¯•</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">3.4 ç»„ä»¶æµ‹è¯•</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id16">4. é›†æˆæµ‹è¯•</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id17">4.1 é¡µé¢æµç¨‹æµ‹è¯•</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">4.2 ç”¨æˆ·äº¤äº’æµ‹è¯•</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#e2e">5. E2Eæµ‹è¯•</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id19">5.1 è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mock">6. Mockæ•°æ®</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id20">6.1 æœ¬åœ°Mock</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">6.2 MockæœåŠ¡</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id22">7. è°ƒè¯•æŠ€å·§</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id23">7.1 æ¡ä»¶æ–­ç‚¹</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id24">7.2 æ—¥å¿—åˆ†çº§</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">7.3 æ€§èƒ½åˆ†æ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id26">7.4 æ•°æ®å¿«ç…§</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id27">8. æµ‹è¯•æœ€ä½³å®è·µ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id28">8.1 æµ‹è¯•è¦†ç›–ç‡</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id29">8.2 æµ‹è¯•é‡‘å­—å¡”</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id30">8.3 æµ‹è¯•å‘½åè§„èŒƒ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id31">8.4 æµ‹è¯•éš”ç¦»</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id32">9. å¸¸è§é—®é¢˜</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q1">Q1: çœŸæœºè°ƒè¯•çœ‹ä¸åˆ°æ—¥å¿—ï¼Ÿ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#q2">Q2: å¦‚ä½•æµ‹è¯•ä¸åŒæœºå‹ï¼Ÿ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3-mock-wx-api">Q3: å•å…ƒæµ‹è¯•å¦‚ä½•Mock wx APIï¼Ÿ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#q4">Q4: å¦‚ä½•æµ‹è¯•å¼‚æ­¥æ“ä½œï¼Ÿ</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id33">å‚è€ƒèµ„æº</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="06-backend-development.html">åç«¯å¼€å‘ä¸é›†æˆ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="ç§»åŠ¨ç‰ˆå¯¼èˆªèœå•"  style="background: #07c160" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Mini Program Tutorial</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="é¡µé¢å¯¼èˆª">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">æµ‹è¯•ä¸è°ƒè¯•</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/05-testing-and-debugging.md.txt" rel="nofollow"> æŸ¥çœ‹é¡µé¢æºç </a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>æµ‹è¯•ä¸è°ƒè¯•<a class="headerlink" href="#id1" title="Link to this heading">ïƒ</a></h1>
<section id="id2">
<h2>ğŸ’¡ æ ¸å¿ƒç»“è®º<a class="headerlink" href="#id2" title="Link to this heading">ïƒ</a></h2>
<ol class="arabic simple">
<li><p><strong>å°ç¨‹åºæµ‹è¯•åŒ…æ‹¬å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€ç«¯åˆ°ç«¯æµ‹è¯•</strong></p></li>
<li><p><strong>å¼€å‘è€…å·¥å…·æä¾›è°ƒè¯•å™¨ã€æ€§èƒ½åˆ†æã€ç½‘ç»œç›‘æ§ç­‰åŠŸèƒ½</strong></p></li>
<li><p><strong>çœŸæœºè°ƒè¯•æ˜¯å‘ç°é—®é¢˜çš„å…³é”®ï¼Œä¸åŒæœºå‹è¡¨ç°å¯èƒ½ä¸åŒ</strong></p></li>
<li><p><strong>Mockæ•°æ®å’Œæµ‹è¯•å·¥å…·å¯ä»¥æå‡å¼€å‘æ•ˆç‡</strong></p></li>
<li><p><strong>è‡ªåŠ¨åŒ–æµ‹è¯•å¯ä»¥ä¿è¯ä»£ç è´¨é‡å’Œç¨³å®šæ€§</strong></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="id3">
<h2>1. å¼€å‘è€…å·¥å…·è°ƒè¯•<a class="headerlink" href="#id3" title="Link to this heading">ïƒ</a></h2>
<section id="id4">
<h3>1.1 è°ƒè¯•å™¨ä½¿ç”¨<a class="headerlink" href="#id4" title="Link to this heading">ïƒ</a></h3>
<p><strong>Consoleé¢æ¿</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// åŸºç¡€æ—¥å¿—</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;æ™®é€šæ—¥å¿—&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s1">&#39;ä¿¡æ¯æ—¥å¿—&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;è­¦å‘Šæ—¥å¿—&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;é”™è¯¯æ—¥å¿—&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span>

<span class="c1">// åˆ†ç»„æ—¥å¿—</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">group</span><span class="p">(</span><span class="s1">&#39;åˆ†ç»„1&#39;</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;å†…å®¹1&#39;</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;å†…å®¹2&#39;</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">groupEnd</span><span class="p">()</span>

<span class="c1">// è¡¨æ ¼æ˜¾ç¤º</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">table</span><span class="p">([</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;å¼ ä¸‰&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">25</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;æå››&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span><span class="w"> </span><span class="p">}</span>
<span class="p">])</span>

<span class="c1">// è®¡æ—¶</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">time</span><span class="p">(</span><span class="s1">&#39;timer&#39;</span><span class="p">)</span>
<span class="c1">// ... ä»£ç æ‰§è¡Œ</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">timeEnd</span><span class="p">(</span><span class="s1">&#39;timer&#39;</span><span class="p">)</span><span class="w">  </span><span class="c1">// è¾“å‡º: timer: 123.456ms</span>
</pre></div>
</div>
<p><strong>Sourcesé¢æ¿</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// æ–­ç‚¹è°ƒè¯•</span>
<span class="c1">// 1. åœ¨ä»£ç è¡Œå·å·¦ä¾§ç‚¹å‡»è®¾ç½®æ–­ç‚¹</span>
<span class="c1">// 2. è§¦å‘ä»£ç æ‰§è¡Œ</span>
<span class="c1">// 3. æŸ¥çœ‹å˜é‡å€¼ã€è°ƒç”¨æ ˆ</span>
<span class="c1">// 4. å•æ­¥æ‰§è¡Œï¼ˆF10ï¼‰ã€è¿›å…¥å‡½æ•°ï¼ˆF11ï¼‰ã€è·³å‡ºå‡½æ•°ï¼ˆShift+F11ï¼‰</span>

<span class="c1">// æ¡ä»¶æ–­ç‚¹</span>
<span class="c1">// å³é”®æ–­ç‚¹ â†’ ç¼–è¾‘æ–­ç‚¹ â†’ è®¾ç½®æ¡ä»¶</span>
<span class="c1">// ä¾‹å¦‚ï¼šindex &gt; 10</span>
</pre></div>
</div>
<p><strong>Networké¢æ¿</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œè¯·æ±‚</span>
<span class="c1">// - è¯·æ±‚URLã€æ–¹æ³•ã€çŠ¶æ€ç </span>
<span class="c1">// - è¯·æ±‚å¤´ã€å“åº”å¤´</span>
<span class="c1">// - è¯·æ±‚å‚æ•°ã€å“åº”æ•°æ®</span>
<span class="c1">// - è¯·æ±‚è€—æ—¶</span>

<span class="c1">// è¿‡æ»¤è¯·æ±‚</span>
<span class="c1">// - æŒ‰ç±»å‹ï¼šXHRã€Imageã€WebSocket</span>
<span class="c1">// - æŒ‰å…³é”®è¯æœç´¢</span>
</pre></div>
</div>
</section>
<section id="id5">
<h3>1.2 æ€§èƒ½åˆ†æ<a class="headerlink" href="#id5" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Performanceé¢æ¿</span>
<span class="c1">// 1. ç‚¹å‡»&quot;å¼€å§‹å½•åˆ¶&quot;</span>
<span class="c1">// 2. æ‰§è¡Œæ“ä½œ</span>
<span class="c1">// 3. ç‚¹å‡»&quot;åœæ­¢å½•åˆ¶&quot;</span>
<span class="c1">// 4. æŸ¥çœ‹æ€§èƒ½æ•°æ®ï¼š</span>
<span class="c1">//    - FPSï¼ˆå¸§ç‡ï¼‰</span>
<span class="c1">//    - CPUä½¿ç”¨ç‡</span>
<span class="c1">//    - å†…å­˜å ç”¨</span>
<span class="c1">//    - setDataè°ƒç”¨æ¬¡æ•°</span>
<span class="c1">//    - æ¸²æŸ“æ—¶é—´</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>1.3 å­˜å‚¨é¢æ¿<a class="headerlink" href="#id6" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Storageé¢æ¿</span>
<span class="c1">// æŸ¥çœ‹ï¼š</span>
<span class="c1">// - Local Storage</span>
<span class="c1">// - Session Storage</span>
<span class="c1">// - å°ç¨‹åºStorageï¼ˆwx.setStorageå­˜å‚¨çš„æ•°æ®ï¼‰</span>

<span class="c1">// å¯ä»¥ï¼š</span>
<span class="c1">// - æŸ¥çœ‹æ‰€æœ‰key-value</span>
<span class="c1">// - ç¼–è¾‘ã€åˆ é™¤æ•°æ®</span>
<span class="c1">// - æ¸…ç©ºæ‰€æœ‰æ•°æ®</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id7">
<h2>2. çœŸæœºè°ƒè¯•<a class="headerlink" href="#id7" title="Link to this heading">ïƒ</a></h2>
<section id="id8">
<h3>2.1 é¢„è§ˆåŠŸèƒ½<a class="headerlink" href="#id8" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># å¼€å‘è€…å·¥å…· â†’ é¢„è§ˆ</span>
<span class="c1"># ç”ŸæˆäºŒç»´ç  â†’ å¾®ä¿¡æ‰«ç  â†’ çœŸæœºé¢„è§ˆ</span>

<span class="c1"># æ³¨æ„äº‹é¡¹ï¼š</span>
<span class="c1"># 1. æ‰‹æœºå’Œç”µè„‘éœ€åœ¨åŒä¸€ç½‘ç»œ</span>
<span class="c1"># 2. éœ€è¦ç™»å½•å¼€å‘è€…è´¦å·</span>
<span class="c1"># 3. å¯ä»¥æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—</span>
</pre></div>
</div>
</section>
<section id="id9">
<h3>2.2 çœŸæœºè°ƒè¯•<a class="headerlink" href="#id9" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># å¼€å‘è€…å·¥å…· â†’ çœŸæœºè°ƒè¯•</span>
<span class="c1"># ç”ŸæˆäºŒç»´ç  â†’ å¾®ä¿¡æ‰«ç  â†’ å¼€å¯è°ƒè¯•</span>

<span class="c1"># åŠŸèƒ½ï¼š</span>
<span class="c1"># 1. å®æ—¶æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—</span>
<span class="c1"># 2. æŸ¥çœ‹ç½‘ç»œè¯·æ±‚</span>
<span class="c1"># 3. æŸ¥çœ‹Storageæ•°æ®</span>
<span class="c1"># 4. æŸ¥çœ‹é¡µé¢ç»“æ„</span>
<span class="c1"># 5. æŸ¥çœ‹å…ƒç´ æ ·å¼</span>
</pre></div>
</div>
</section>
<section id="id10">
<h3>2.3 è¿œç¨‹è°ƒè¯•<a class="headerlink" href="#id10" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// å°ç¨‹åºåå° â†’ å¼€å‘ â†’ å¼€å‘ç®¡ç† â†’ å¼€å‘è®¾ç½® â†’ è¿œç¨‹è°ƒè¯•</span>

<span class="c1">// ä½¿ç”¨åœºæ™¯ï¼š</span>
<span class="c1">// 1. çœŸæœºé¢„è§ˆæ— æ³•å¤ç°é—®é¢˜</span>
<span class="c1">// 2. éœ€è¦æŸ¥çœ‹è¯¦ç»†æ—¥å¿—</span>
<span class="c1">// 3. éœ€è¦è°ƒè¯•ç‰¹å®šåŠŸèƒ½</span>
</pre></div>
</div>
</section>
<section id="id11">
<h3>2.4 å¸¸è§çœŸæœºé—®é¢˜<a class="headerlink" href="#id11" title="Link to this heading">ïƒ</a></h3>
<p><strong>1. æ ·å¼é—®é¢˜</strong>ï¼š</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="c">/* ä¸åŒæœºå‹å¯èƒ½è¡¨ç°ä¸åŒ */</span>
<span class="c">/* ä½¿ç”¨rpxå•ä½ï¼Œé¿å…ä½¿ç”¨px */</span>
<span class="p">.</span><span class="nc">container</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">750</span><span class="n">rpx</span><span class="p">;</span><span class="w">  </span><span class="c">/* âœ… æ­£ç¡® */</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">375</span><span class="kt">px</span><span class="p">;</span><span class="w">   </span><span class="c">/* âŒ å¯èƒ½åœ¨ä¸åŒæœºå‹æ˜¾ç¤ºå¼‚å¸¸ */</span>
<span class="p">}</span>

<span class="c">/* æµ‹è¯•ä¸åŒæœºå‹ */</span>
<span class="c">/* iPhoneã€Androidã€iPad */</span>
</pre></div>
</div>
<p><strong>2. å…¼å®¹æ€§é—®é¢˜</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// æ£€æŸ¥APIæ”¯æŒ</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">wx</span><span class="p">.</span><span class="nx">canIUse</span><span class="p">(</span><span class="s1">&#39;getUpdateManager&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ä½¿ç”¨æ–°API</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// é™çº§æ–¹æ¡ˆ</span>
<span class="p">}</span>

<span class="c1">// æ£€æŸ¥åŸºç¡€åº“ç‰ˆæœ¬</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">systemInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">getSystemInfoSync</span><span class="p">()</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;åŸºç¡€åº“ç‰ˆæœ¬&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">systemInfo</span><span class="p">.</span><span class="nx">SDKVersion</span><span class="p">)</span>

<span class="c1">// æœ€ä½åŸºç¡€åº“ç‰ˆæœ¬è¦æ±‚</span>
<span class="c1">// app.json</span>
<span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;libVersion&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2.19.4&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>3. ç½‘ç»œé—®é¢˜</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// çœŸæœºç½‘ç»œç¯å¢ƒå¯èƒ½ä¸åŒ</span>
<span class="c1">// æµ‹è¯•ï¼š</span>
<span class="c1">// - WiFiç¯å¢ƒ</span>
<span class="c1">// - 4G/5Gç¯å¢ƒ</span>
<span class="c1">// - å¼±ç½‘ç¯å¢ƒ</span>

<span class="c1">// æ¨¡æ‹Ÿå¼±ç½‘</span>
<span class="c1">// å¼€å‘è€…å·¥å…· â†’ è®¾ç½® â†’ é¡¹ç›®è®¾ç½® â†’ ä¸æ ¡éªŒåˆæ³•åŸŸå</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id12">
<h2>3. å•å…ƒæµ‹è¯•<a class="headerlink" href="#id12" title="Link to this heading">ïƒ</a></h2>
<section id="id13">
<h3>3.1 æµ‹è¯•æ¡†æ¶é…ç½®<a class="headerlink" href="#id13" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># å®‰è£…ä¾èµ–</span>
npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>jest<span class="w"> </span>@miniprogram/jest

<span class="c1"># æˆ–ä½¿ç”¨miniprogram-simulate</span>
npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>miniprogram-simulate
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="c1">// package.json</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;scripts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jest&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;test:watch&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jest --watch&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;test:coverage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jest --coverage&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;jest&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;preset&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;@miniprogram/jest&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;testEnvironment&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jsdom&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;testMatch&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;**/__tests__/**/*.test.js&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;collectCoverageFrom&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;**/*.js&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;!**/node_modules/**&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;!**/dist/**&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id14">
<h3>3.2 å·¥å…·å‡½æ•°æµ‹è¯•<a class="headerlink" href="#id14" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// utils/format.test.js</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">formatPrice</span><span class="p">,</span><span class="w"> </span><span class="nx">formatDate</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./format.js&#39;</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;formatå·¥å…·å‡½æ•°&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;formatPriceåº”è¯¥æ­£ç¡®æ ¼å¼åŒ–ä»·æ ¼&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">formatPrice</span><span class="p">(</span><span class="mf">100</span><span class="p">)).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Â¥1.00&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">formatPrice</span><span class="p">(</span><span class="mf">1234</span><span class="p">)).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Â¥12.34&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">formatPrice</span><span class="p">(</span><span class="mf">0</span><span class="p">)).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Â¥0.00&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;formatDateåº”è¯¥æ­£ç¡®æ ¼å¼åŒ–æ—¥æœŸ&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">date</span><span class="p">)).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// utils/format.js</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">formatPrice</span><span class="p">(</span><span class="nx">price</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Â¥&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">price</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">String</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">).</span><span class="nx">padStart</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">String</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()).</span><span class="nx">padStart</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">year</span><span class="si">}</span><span class="sb">-</span><span class="si">${</span><span class="nx">month</span><span class="si">}</span><span class="sb">-</span><span class="si">${</span><span class="nx">day</span><span class="si">}</span><span class="sb">`</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="api">
<h3>3.3 APIæµ‹è¯•<a class="headerlink" href="#api" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// utils/request.test.js</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">http</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./request.js&#39;</span>

<span class="c1">// Mock wx.request</span>
<span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="s1">&#39;wx&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">  </span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
<span class="p">}))</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;requestå·¥å…·&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">beforeEach</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">jest</span><span class="p">.</span><span class="nx">clearAllMocks</span><span class="p">()</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;getè¯·æ±‚åº”è¯¥æ­£ç¡®è°ƒç”¨wx.request&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">mockData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">list</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">mockImplementation</span><span class="p">((</span><span class="nx">options</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">({</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="nx">mockData</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/api/products&#39;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="p">).</span><span class="nx">toHaveBeenCalledWith</span><span class="p">(</span>
<span class="w">      </span><span class="nx">expect</span><span class="p">.</span><span class="nx">objectContaining</span><span class="p">({</span>
<span class="w">        </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="nx">expect</span><span class="p">.</span><span class="nx">stringContaining</span><span class="p">(</span><span class="s1">&#39;/api/products&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="nx">mockData</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;è¯·æ±‚å¤±è´¥åº”è¯¥æŠ›å‡ºé”™è¯¯&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">mockImplementation</span><span class="p">((</span><span class="nx">options</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">options</span><span class="p">.</span><span class="nx">fail</span><span class="p">({</span><span class="w"> </span><span class="nx">errMsg</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;request:fail&#39;</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">expect</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/api/products&#39;</span><span class="p">)).</span><span class="nx">rejects</span><span class="p">.</span><span class="nx">toThrow</span><span class="p">()</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id15">
<h3>3.4 ç»„ä»¶æµ‹è¯•<a class="headerlink" href="#id15" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// components/product-item/product-item.test.js</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">simulate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;miniprogram-simulate&#39;</span><span class="p">)</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;ProductItemç»„ä»¶&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">comp</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">beforeEach</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">comp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">simulate</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="s1">&#39;/components/product-item/product-item&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;åº”è¯¥æ­£ç¡®æ˜¾ç¤ºå•†å“ä¿¡æ¯&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;æµ‹è¯•å•†å“&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="mf">10000</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">comp</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="nx">comp</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">comp</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.product-name&#39;</span><span class="p">).</span><span class="nx">textContent</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;æµ‹è¯•å•†å“&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">comp</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.product-price&#39;</span><span class="p">).</span><span class="nx">textContent</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Â¥100.00&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;ç‚¹å‡»åº”è¯¥è§¦å‘tapäº‹ä»¶&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;æµ‹è¯•å•†å“&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="mf">10000</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="nx">comp</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="nx">comp</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tapHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
<span class="w">    </span><span class="nx">comp</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;tap&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">tapHandler</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">comp</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.product-item&#39;</span><span class="p">).</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="s1">&#39;tap&#39;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">tapHandler</span><span class="p">).</span><span class="nx">toHaveBeenCalledWith</span><span class="p">(</span>
<span class="w">      </span><span class="nx">expect</span><span class="p">.</span><span class="nx">objectContaining</span><span class="p">({</span>
<span class="w">        </span><span class="nx">detail</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id16">
<h2>4. é›†æˆæµ‹è¯•<a class="headerlink" href="#id16" title="Link to this heading">ïƒ</a></h2>
<section id="id17">
<h3>4.1 é¡µé¢æµç¨‹æµ‹è¯•<a class="headerlink" href="#id17" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// tests/pages/index.test.js</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">simulate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;miniprogram-simulate&#39;</span><span class="p">)</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;é¦–é¡µæµç¨‹æµ‹è¯•&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">page</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">beforeEach</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">simulate</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="s1">&#39;/pages/index/index&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;é¡µé¢åŠ è½½åº”è¯¥è¯·æ±‚æ•°æ®&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">mockRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mockRequest</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">page</span><span class="p">.</span><span class="nx">triggerLifeTime</span><span class="p">(</span><span class="s1">&#39;onLoad&#39;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">simulate</span><span class="p">.</span><span class="nx">sleep</span><span class="p">(</span><span class="mf">100</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">mockRequest</span><span class="p">).</span><span class="nx">toHaveBeenCalled</span><span class="p">()</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;ä¸‹æ‹‰åˆ·æ–°åº”è¯¥é‡æ–°åŠ è½½æ•°æ®&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">mockRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mockRequest</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">page</span><span class="p">.</span><span class="nx">triggerLifeTime</span><span class="p">(</span><span class="s1">&#39;onPullDownRefresh&#39;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">simulate</span><span class="p">.</span><span class="nx">sleep</span><span class="p">(</span><span class="mf">100</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">mockRequest</span><span class="p">).</span><span class="nx">toHaveBeenCalled</span><span class="p">()</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">wx</span><span class="p">.</span><span class="nx">stopPullDownRefresh</span><span class="p">).</span><span class="nx">toHaveBeenCalled</span><span class="p">()</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;ä¸Šæ‹‰åŠ è½½åº”è¯¥åŠ è½½æ›´å¤š&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">page</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">      </span><span class="nx">list</span><span class="o">:</span><span class="w"> </span><span class="nb">Array</span><span class="p">(</span><span class="mf">10</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">map</span><span class="p">((</span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">}))</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">mockRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mockRequest</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">page</span><span class="p">.</span><span class="nx">triggerLifeTime</span><span class="p">(</span><span class="s1">&#39;onReachBottom&#39;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">simulate</span><span class="p">.</span><span class="nx">sleep</span><span class="p">(</span><span class="mf">100</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">mockRequest</span><span class="p">).</span><span class="nx">toHaveBeenCalled</span><span class="p">()</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id18">
<h3>4.2 ç”¨æˆ·äº¤äº’æµ‹è¯•<a class="headerlink" href="#id18" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// tests/user-interaction.test.js</span>
<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;ç”¨æˆ·äº¤äº’æµ‹è¯•&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;ç‚¹å‡»æŒ‰é’®åº”è¯¥è§¦å‘ç›¸åº”æ“ä½œ&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">simulate</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="s1">&#39;/pages/index/index&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">page</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.submit-button&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">submitHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">page</span><span class="p">.</span><span class="nx">instance</span><span class="p">.</span><span class="nx">onSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">submitHandler</span>
<span class="w">    </span><span class="nx">button</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="s1">&#39;tap&#39;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">submitHandler</span><span class="p">).</span><span class="nx">toHaveBeenCalled</span><span class="p">()</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;è¾“å…¥æ¡†è¾“å…¥åº”è¯¥æ›´æ–°æ•°æ®&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">simulate</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="s1">&#39;/pages/index/index&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">page</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.search-input&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">input</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">detail</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;æµ‹è¯•&#39;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">page</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">keyword</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;æµ‹è¯•&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="e2e">
<h2>5. E2Eæµ‹è¯•<a class="headerlink" href="#e2e" title="Link to this heading">ïƒ</a></h2>
<section id="id19">
<h3>5.1 è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·<a class="headerlink" href="#id19" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># å®‰è£…miniprogram-automator</span>
npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>miniprogram-automator
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// tests/e2e/index.test.js</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">automator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;miniprogram-automator&#39;</span><span class="p">)</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;E2Eæµ‹è¯•&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">miniProgram</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">page</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">beforeAll</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">miniProgram</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">automator</span><span class="p">.</span><span class="nx">launch</span><span class="p">({</span>
<span class="w">      </span><span class="nx">projectPath</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./miniprogram&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">cliPath</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;/Applications/wechatwebdevtools.app/Contents/MacOS/cli&#39;</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">miniProgram</span><span class="p">.</span><span class="nx">reLaunch</span><span class="p">(</span><span class="s1">&#39;/pages/index/index&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">waitFor</span><span class="p">(</span><span class="mf">1000</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">afterAll</span><span class="p">(</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">miniProgram</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;åº”è¯¥æ­£ç¡®æ˜¾ç¤ºé¦–é¡µå†…å®¹&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.page-title&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">title</span><span class="p">.</span><span class="nx">text</span><span class="p">()</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">text</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;é¦–é¡µ&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;åº”è¯¥èƒ½å¤Ÿæœç´¢å•†å“&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">searchInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.search-input&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">searchInput</span><span class="p">.</span><span class="nx">input</span><span class="p">(</span><span class="s1">&#39;æ‰‹æœº&#39;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">searchButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.search-button&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">searchButton</span><span class="p">.</span><span class="nx">tap</span><span class="p">()</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">waitFor</span><span class="p">(</span><span class="mf">2000</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">$$</span><span class="p">(</span><span class="s1">&#39;.product-item&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">products</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">toBeGreaterThan</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;åº”è¯¥èƒ½å¤Ÿæ·»åŠ å•†å“åˆ°è´­ç‰©è½¦&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">addButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.add-to-cart&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">addButton</span><span class="p">.</span><span class="nx">tap</span><span class="p">()</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">waitFor</span><span class="p">(</span><span class="mf">500</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">toast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">page</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.weui-toast&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">toastText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">toast</span><span class="p">.</span><span class="nx">text</span><span class="p">()</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">toastText</span><span class="p">).</span><span class="nx">toContain</span><span class="p">(</span><span class="s1">&#39;æ·»åŠ æˆåŠŸ&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="mock">
<h2>6. Mockæ•°æ®<a class="headerlink" href="#mock" title="Link to this heading">ïƒ</a></h2>
<section id="id20">
<h3>6.1 æœ¬åœ°Mock<a class="headerlink" href="#id20" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// mock/api.js</span>
<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">mockData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;å•†å“1&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="mf">10000</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;å•†å“2&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="mf">20000</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;æµ‹è¯•ç”¨æˆ·&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">avatar</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://example.com/avatar.png&#39;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// utils/request.js</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">mockData</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../mock/api.js&#39;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">isDev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;development&#39;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">useMock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">isDev</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">getStorageSync</span><span class="p">(</span><span class="s1">&#39;useMock&#39;</span><span class="p">)</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">request</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">useMock</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">mockData</span><span class="p">[</span><span class="nx">options</span><span class="p">.</span><span class="nx">url</span><span class="p">])</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="nx">reject</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
<span class="w">      </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="nx">options</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span>
<span class="w">      </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="nx">resolve</span><span class="p">,</span>
<span class="w">      </span><span class="nx">fail</span><span class="o">:</span><span class="w"> </span><span class="nx">reject</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id21">
<h3>6.2 MockæœåŠ¡<a class="headerlink" href="#id21" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// ä½¿ç”¨mockjs</span>
<span class="c1">// npm install mockjs</span>

<span class="c1">// mock/index.js</span>
<span class="k">import</span><span class="w"> </span><span class="nx">Mock</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;mockjs&#39;</span>

<span class="nx">Mock</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="s1">&#39;/api/products&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;get&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">code</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">list</span><span class="o">:</span><span class="w"> </span><span class="nx">Mock</span><span class="p">.</span><span class="nx">mock</span><span class="p">({</span>
<span class="w">      </span><span class="s1">&#39;list|10&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span>
<span class="w">        </span><span class="s1">&#39;id|+1&#39;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;@ctitle(5, 10)&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;price|1000-10000&#39;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;image&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;@image(&quot;200x200&quot;)&#39;</span>
<span class="w">      </span><span class="p">}]</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>

<span class="c1">// åœ¨å¼€å‘ç¯å¢ƒå¯ç”¨</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;development&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./mock&#39;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id22">
<h2>7. è°ƒè¯•æŠ€å·§<a class="headerlink" href="#id22" title="Link to this heading">ïƒ</a></h2>
<section id="id23">
<h3>7.1 æ¡ä»¶æ–­ç‚¹<a class="headerlink" href="#id23" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// åªåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æš‚åœ</span>
<span class="c1">// ä¾‹å¦‚ï¼šåªåœ¨index &gt; 10æ—¶æš‚åœ</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// è®¾ç½®æ¡ä»¶æ–­ç‚¹ï¼ši &gt; 10</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id24">
<h3>7.2 æ—¥å¿—åˆ†çº§<a class="headerlink" href="#id24" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// utils/logger.js</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">DEBUG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">getStorageSync</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;true&#39;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">debug</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">DEBUG</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[DEBUG]&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">info</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[INFO]&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">args</span><span class="p">)</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">error</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;[ERROR]&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">args</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id25">
<h3>7.3 æ€§èƒ½åˆ†æ<a class="headerlink" href="#id25" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// utils/performance.js</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">measure</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">fn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fn</span><span class="p">()</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`[Performance] </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">: </span><span class="si">${</span><span class="nx">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">start</span><span class="si">}</span><span class="sb">ms`</span><span class="p">)</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span>
<span class="p">}</span>

<span class="c1">// ä½¿ç”¨</span>
<span class="nx">measure</span><span class="p">(</span><span class="s1">&#39;loadData&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">loadData</span><span class="p">()</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id26">
<h3>7.4 æ•°æ®å¿«ç…§<a class="headerlink" href="#id26" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// ä¿å­˜æ•°æ®å¿«ç…§ç”¨äºè°ƒè¯•</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">snapshot</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;snapshot&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">snapshotData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">wx</span><span class="p">.</span><span class="nx">setStorageSync</span><span class="p">(</span><span class="sb">`snapshot_</span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="nx">snapshotData</span><span class="p">)</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`[Snapshot] </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb"> saved`</span><span class="p">,</span><span class="w"> </span><span class="nx">snapshotData</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// ä½¿ç”¨</span>
<span class="nx">snapshot</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pageData&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id27">
<h2>8. æµ‹è¯•æœ€ä½³å®è·µ<a class="headerlink" href="#id27" title="Link to this heading">ïƒ</a></h2>
<section id="id28">
<h3>8.1 æµ‹è¯•è¦†ç›–ç‡<a class="headerlink" href="#id28" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š</span>
npm<span class="w"> </span>run<span class="w"> </span>test:coverage

<span class="c1"># ç›®æ ‡è¦†ç›–ç‡ï¼š</span>
<span class="c1"># - è¯­å¥è¦†ç›–ç‡ &gt; 80%</span>
<span class="c1"># - åˆ†æ”¯è¦†ç›–ç‡ &gt; 75%</span>
<span class="c1"># - å‡½æ•°è¦†ç›–ç‡ &gt; 80%</span>
</pre></div>
</div>
</section>
<section id="id29">
<h3>8.2 æµ‹è¯•é‡‘å­—å¡”<a class="headerlink" href="#id29" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        /\
       /E2E\        â† å°‘é‡ç«¯åˆ°ç«¯æµ‹è¯•
      /------\
     /é›†æˆæµ‹è¯•\      â† é€‚é‡é›†æˆæµ‹è¯•
    /----------\
   /  å•å…ƒæµ‹è¯•  \    â† å¤§é‡å•å…ƒæµ‹è¯•
  /--------------\
</pre></div>
</div>
</section>
<section id="id30">
<h3>8.3 æµ‹è¯•å‘½åè§„èŒƒ<a class="headerlink" href="#id30" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// âœ… å¥½çš„æµ‹è¯•å‘½å</span>
<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;ProductItemç»„ä»¶&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;åº”è¯¥æ­£ç¡®æ˜¾ç¤ºå•†å“åç§°å’Œä»·æ ¼&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{})</span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;ç‚¹å‡»å•†å“åº”è¯¥è·³è½¬åˆ°è¯¦æƒ…é¡µ&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{})</span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;ä»·æ ¼åº”è¯¥æ ¼å¼åŒ–ä¸ºä¸¤ä½å°æ•°&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{})</span>
<span class="p">})</span>

<span class="c1">// âŒ ä¸å¥½çš„æµ‹è¯•å‘½å</span>
<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{})</span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;test2&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{})</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id31">
<h3>8.4 æµ‹è¯•éš”ç¦»<a class="headerlink" href="#id31" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// æ¯ä¸ªæµ‹è¯•åº”è¯¥ç‹¬ç«‹ï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•</span>
<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;ç”¨æˆ·ç™»å½•&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">beforeEach</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// æ¯ä¸ªæµ‹è¯•å‰é‡ç½®çŠ¶æ€</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">clearStorageSync</span><span class="p">()</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;åº”è¯¥èƒ½å¤Ÿç™»å½•&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// æµ‹è¯•ä»£ç </span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;ç™»å½•å¤±è´¥åº”è¯¥æ˜¾ç¤ºé”™è¯¯&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// æµ‹è¯•ä»£ç </span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id32">
<h2>9. å¸¸è§é—®é¢˜<a class="headerlink" href="#id32" title="Link to this heading">ïƒ</a></h2>
<section id="q1">
<h3>Q1: çœŸæœºè°ƒè¯•çœ‹ä¸åˆ°æ—¥å¿—ï¼Ÿ<a class="headerlink" href="#q1" title="Link to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<ol class="arabic simple">
<li><p>ç¡®è®¤å¼€å¯äº†çœŸæœºè°ƒè¯•æ¨¡å¼</p></li>
<li><p>æ£€æŸ¥æ‰‹æœºå’Œç”µè„‘æ˜¯å¦åœ¨åŒä¸€ç½‘ç»œ</p></li>
<li><p>å°è¯•é‡å¯å¼€å‘è€…å·¥å…·</p></li>
<li><p>æ£€æŸ¥é˜²ç«å¢™è®¾ç½®</p></li>
</ol>
</section>
<section id="q2">
<h3>Q2: å¦‚ä½•æµ‹è¯•ä¸åŒæœºå‹ï¼Ÿ<a class="headerlink" href="#q2" title="Link to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<ol class="arabic simple">
<li><p>ä½¿ç”¨çœŸæœºé¢„è§ˆåŠŸèƒ½</p></li>
<li><p>å‡†å¤‡å¤šå°æµ‹è¯•è®¾å¤‡</p></li>
<li><p>ä½¿ç”¨äº‘æµ‹è¯•å¹³å°ï¼ˆå¦‚Testinã€WeTestï¼‰</p></li>
</ol>
</section>
<section id="q3-mock-wx-api">
<h3>Q3: å•å…ƒæµ‹è¯•å¦‚ä½•Mock wx APIï¼Ÿ<a class="headerlink" href="#q3-mock-wx-api" title="Link to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// ä½¿ç”¨jest.mock</span>
<span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="s1">&#39;wx&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<span class="w">  </span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">(),</span>
<span class="w">  </span><span class="nx">showToast</span><span class="o">:</span><span class="w"> </span><span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
<span class="p">}))</span>
</pre></div>
</div>
</section>
<section id="q4">
<h3>Q4: å¦‚ä½•æµ‹è¯•å¼‚æ­¥æ“ä½œï¼Ÿ<a class="headerlink" href="#q4" title="Link to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;åº”è¯¥å¼‚æ­¥åŠ è½½æ•°æ®&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">promise</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">loadData</span><span class="p">()</span>
<span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">expect</span><span class="p">(</span><span class="nx">promise</span><span class="p">).</span><span class="nx">resolves</span><span class="p">.</span><span class="nx">toEqual</span><span class="p">(</span><span class="nx">expectedData</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id33">
<h2>å‚è€ƒèµ„æº<a class="headerlink" href="#id33" title="Link to this heading">ïƒ</a></h2>
<ul class="simple">
<li><p>å¾®ä¿¡å¼€å‘è€…å·¥å…·æ–‡æ¡£</p></li>
<li><p>Jestæµ‹è¯•æ¡†æ¶æ–‡æ¡£</p></li>
<li><p>miniprogram-simulateæ–‡æ¡£</p></li>
<li><p>å°ç¨‹åºæµ‹è¯•æœ€ä½³å®è·µ</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="é¡µè„š">
        <a href="04-deployment-and-release.html" class="btn btn-neutral float-left" title="éƒ¨ç½²ä¸å‘å¸ƒ" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> ä¸Šä¸€é¡µ</a>
        <a href="06-backend-development.html" class="btn btn-neutral float-right" title="åç«¯å¼€å‘ä¸é›†æˆ" accesskey="n" rel="next">ä¸‹ä¸€é¡µ <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; ç‰ˆæƒæ‰€æœ‰ 2025, Code Dojoã€‚</p>
  </div>

  åˆ©ç”¨ <a href="https://www.sphinx-doc.org/">Sphinx</a> æ„å»ºï¼Œä½¿ç”¨çš„ 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">ä¸»é¢˜</a>
    ç”± <a href="https://readthedocs.org">Read the Docs</a> å¼€å‘.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>