

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ &mdash; Mini Program Tutorial 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=d25bc049" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=af2ce170"></script>
      <script src="_static/doctools.js?v=888ff710"></script>
      <script src="_static/sphinx_highlight.js?v=4825356b"></script>
      <script src="_static/copy-code.js?v=caf91246"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="éƒ¨ç½²ä¸å‘å¸ƒ" href="04-deployment-and-release.html" />
    <link rel="prev" title="ç½‘ç»œè¯·æ±‚ä¸äº‘å¼€å‘" href="02-network-request-and-cloud.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #07c160" >

          
          
          <a href="index.html" class="icon icon-home">
            Mini Program Tutorial
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">ç›®å½•</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">WeChat Mini Program Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-wechat-miniprogram-basics.html">åŸºç¡€</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-network-request-and-cloud.html">ç½‘ç»œè¯·æ±‚ä¸äº‘å¼€å‘</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">ğŸ’¡ æ ¸å¿ƒç»“è®º</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setdata">1. setDataä¼˜åŒ–</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">1.1 setDataåŸç†</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">1.2 ä¼˜åŒ–ç­–ç•¥</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id5">2. é•¿åˆ—è¡¨ä¼˜åŒ–</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">2.1 è™šæ‹Ÿåˆ—è¡¨</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">2.2 åˆ†é¡µåŠ è½½</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id8">3. å›¾ç‰‡ä¼˜åŒ–</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">3.1 å›¾ç‰‡æ‡’åŠ è½½</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">3.2 å›¾ç‰‡é¢„åŠ è½½</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">3.3 å›¾ç‰‡å‹ç¼©</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id12">4. åˆ†åŒ…åŠ è½½</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id13">4.1 åˆ†åŒ…é…ç½®</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">4.2 åˆ†åŒ…è·³è½¬</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id15">5. ç¼“å­˜ç­–ç•¥</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id16">5.1 æ•°æ®ç¼“å­˜</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">5.2 å›¾ç‰‡ç¼“å­˜</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id18">6. ä»£ç ä¼˜åŒ–</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id19">6.1 å‡å°‘åŒ…ä½“ç§¯</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">6.2 é¿å…ä¸å¿…è¦çš„æ¸²æŸ“</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">6.3 ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id22">7. æ€§èƒ½ç›‘æ§</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id23">7.1 æ€§èƒ½æ•°æ®ä¸ŠæŠ¥</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id24">7.2 ä½“éªŒè¯„åˆ†</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id25">8. æœ€ä½³å®è·µ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id26">8.1 ä»£ç è§„èŒƒ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">8.2 ç›®å½•ç»“æ„</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">8.3 ç”¨æˆ·ä½“éªŒ</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id29">9. å¸¸è§é—®é¢˜</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q1">Q1: å¦‚ä½•è°ƒè¯•æ€§èƒ½é—®é¢˜ï¼Ÿ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#q2">Q2: å¦‚ä½•ä¼˜åŒ–é¦–å±åŠ è½½é€Ÿåº¦ï¼Ÿ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3">Q3: å¦‚ä½•å‡å°‘åŒ…ä½“ç§¯ï¼Ÿ</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id30">å‚è€ƒèµ„æº</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="04-deployment-and-release.html">éƒ¨ç½²ä¸å‘å¸ƒ</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-testing-and-debugging.html">æµ‹è¯•ä¸è°ƒè¯•</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-backend-development.html">åç«¯å¼€å‘ä¸é›†æˆ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #07c160" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Mini Program Tutorial</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/03-performance-optimization.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ<a class="headerlink" href="#id1" title="Permalink to this heading">ïƒ</a></h1>
<section id="id2">
<h2>ğŸ’¡ æ ¸å¿ƒç»“è®º<a class="headerlink" href="#id2" title="Permalink to this heading">ïƒ</a></h2>
<ol class="arabic simple">
<li><p><strong>setDataæ˜¯æ€§èƒ½ç“¶é¢ˆï¼Œéœ€æ§åˆ¶é¢‘ç‡å’Œæ•°æ®é‡</strong></p></li>
<li><p><strong>å›¾ç‰‡æ‡’åŠ è½½å’Œé¢„åŠ è½½å¯æ˜¾è‘—æå‡ä½“éªŒ</strong></p></li>
<li><p><strong>åˆ†åŒ…åŠ è½½å¯çªç ´2MBä¸»åŒ…é™åˆ¶</strong></p></li>
<li><p><strong>é•¿åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨ï¼Œé¿å…ä¸€æ¬¡æ€§æ¸²æŸ“å¤§é‡èŠ‚ç‚¹</strong></p></li>
<li><p><strong>åˆç†ä½¿ç”¨ç¼“å­˜ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚</strong></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="setdata">
<h2>1. setDataä¼˜åŒ–<a class="headerlink" href="#setdata" title="Permalink to this heading">ïƒ</a></h2>
<section id="id3">
<h3>1.1 setDataåŸç†<a class="headerlink" href="#id3" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>é€»è¾‘å±‚(JS)  â†’  åºåˆ—åŒ–æ•°æ®  â†’  WebViewçº¿ç¨‹  â†’  é‡æ–°æ¸²æŸ“
         â†‘                             â†“
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è€—æ—¶è¿‡ç¨‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre></div>
</div>
<p><strong>é—®é¢˜</strong>ï¼š</p>
<ul class="simple">
<li><p>æ•°æ®ä¼ è¾“æœ‰æ€§èƒ½å¼€é”€</p></li>
<li><p>ä¼šé˜»å¡ç”¨æˆ·äº¤äº’</p></li>
<li><p>é¢‘ç¹è°ƒç”¨å¯¼è‡´å¡é¡¿</p></li>
</ul>
</section>
<section id="id4">
<h3>1.2 ä¼˜åŒ–ç­–ç•¥<a class="headerlink" href="#id4" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>1. åªæ›´æ–°å¿…è¦çš„æ•°æ®</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// âŒ é”™è¯¯ï¼šæ›´æ–°æ•´ä¸ªå¯¹è±¡</span>
<span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">  </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;å¼ ä¸‰&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">25</span><span class="p">,</span>
<span class="w">    </span><span class="nx">address</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;åŒ—äº¬&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">avatar</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://...&#39;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>

<span class="c1">// âœ… æ­£ç¡®ï¼šåªæ›´æ–°å˜åŒ–çš„å­—æ®µ</span>
<span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">  </span><span class="s1">&#39;user.name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;æå››&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
<p><strong>2. åˆå¹¶å¤šæ¬¡setData</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// âŒ é”™è¯¯ï¼šå¤šæ¬¡è°ƒç”¨</span>
<span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">})</span>
<span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;å¼ ä¸‰&#39;</span><span class="w"> </span><span class="p">})</span>
<span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">25</span><span class="w"> </span><span class="p">})</span>

<span class="c1">// âœ… æ­£ç¡®ï¼šåˆå¹¶è°ƒç”¨</span>
<span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">  </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;å¼ ä¸‰&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">25</span>
<span class="p">})</span>
</pre></div>
</div>
<p><strong>3. æ§åˆ¶æ•°æ®é‡</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// âŒ é”™è¯¯ï¼šä¼ è¾“å¤§é‡æ•°æ®</span>
<span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">  </span><span class="nx">list</span><span class="o">:</span><span class="w"> </span><span class="nx">hugeArray</span><span class="w">  </span><span class="c1">// 1000ä¸ªå¤æ‚å¯¹è±¡</span>
<span class="p">})</span>

<span class="c1">// âœ… æ­£ç¡®ï¼šåˆ†é¡µåŠ è½½</span>
<span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">  </span><span class="nx">list</span><span class="o">:</span><span class="w"> </span><span class="nx">hugeArray</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p><strong>4. é˜²æŠ–å’ŒèŠ‚æµ</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// utils/debounce.js</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">debounce</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span><span class="w"> </span><span class="nx">delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">500</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kd">function</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">timer</span><span class="p">)</span><span class="w"> </span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timer</span><span class="p">)</span>
<span class="w">    </span><span class="nx">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="nx">delay</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ä½¿ç”¨</span>
<span class="nx">Page</span><span class="p">({</span>
<span class="w">  </span><span class="nx">onInput</span><span class="o">:</span><span class="w"> </span><span class="nx">debounce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">      </span><span class="nx">keyword</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">search</span><span class="p">()</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="mf">300</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p><strong>5. é¿å…åœ¨åå°æ€è°ƒç”¨</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Page</span><span class="p">({</span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">isActive</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">onShow</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">isActive</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">})</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">onHide</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">isActive</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">})</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">updateData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// åªåœ¨é¡µé¢æ¿€æ´»æ—¶æ›´æ–°</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">isActive</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="cm">/* data */</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id5">
<h2>2. é•¿åˆ—è¡¨ä¼˜åŒ–<a class="headerlink" href="#id5" title="Permalink to this heading">ïƒ</a></h2>
<section id="id6">
<h3>2.1 è™šæ‹Ÿåˆ—è¡¨<a class="headerlink" href="#id6" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// components/virtual-list/virtual-list.js</span>
<span class="nx">Component</span><span class="p">({</span>
<span class="w">  </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">list</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">Array</span><span class="p">,</span>
<span class="w">      </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">itemHeight</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">Number</span><span class="p">,</span>
<span class="w">      </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">visibleData</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">    </span><span class="nx">startIndex</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
<span class="w">    </span><span class="nx">endIndex</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span>
<span class="w">    </span><span class="nx">scrollTop</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">lifetimes</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">attached</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">updateVisibleData</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">methods</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">onScroll</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">scrollTop</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">detail</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">scrollTop</span><span class="w"> </span><span class="p">})</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">updateVisibleData</span><span class="p">()</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">updateVisibleData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">list</span><span class="p">,</span><span class="w"> </span><span class="nx">itemHeight</span><span class="p">,</span><span class="w"> </span><span class="nx">scrollTop</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">data</span>
<span class="w">      </span>
<span class="w">      </span><span class="c1">// è®¡ç®—å¯è§åŒºåŸŸ</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">viewportHeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">getSystemInfoSync</span><span class="p">().</span><span class="nx">windowHeight</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">startIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">scrollTop</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">itemHeight</span><span class="p">)</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">endIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">((</span><span class="nx">scrollTop</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">viewportHeight</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">itemHeight</span><span class="p">)</span>
<span class="w">      </span>
<span class="w">      </span><span class="c1">// æ·»åŠ ç¼“å†²åŒº</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">bufferSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">startIndex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">bufferSize</span><span class="p">)</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="nx">endIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">bufferSize</span><span class="p">)</span>
<span class="w">      </span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">        </span><span class="nx">visibleData</span><span class="o">:</span><span class="w"> </span><span class="nx">list</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span><span class="w"> </span><span class="nx">end</span><span class="p">),</span>
<span class="w">        </span><span class="nx">startIndex</span><span class="o">:</span><span class="w"> </span><span class="nx">start</span><span class="p">,</span>
<span class="w">        </span><span class="nx">endIndex</span><span class="o">:</span><span class="w"> </span><span class="nx">end</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id7">
<h3>2.2 åˆ†é¡µåŠ è½½<a class="headerlink" href="#id7" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Page</span><span class="p">({</span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">list</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">    </span><span class="nx">page</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="nx">hasMore</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">loading</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">onLoad</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">loadData</span><span class="p">()</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">onReachBottom</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">hasMore</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">loading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">      </span><span class="nx">page</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">page</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">loadData</span><span class="p">()</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">loadData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">loading</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
<span class="w">        </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://api.example.com/list&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">page</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">page</span><span class="p">,</span>
<span class="w">          </span><span class="nx">size</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">newList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">list</span>
<span class="w">      </span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">        </span><span class="nx">list</span><span class="o">:</span><span class="w"> </span><span class="p">[...</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">list</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">newList</span><span class="p">],</span>
<span class="w">        </span><span class="nx">hasMore</span><span class="o">:</span><span class="w"> </span><span class="nx">newList</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">20</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">loading</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1">// ä¸‹æ‹‰åˆ·æ–°</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">onPullDownRefresh</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">      </span><span class="nx">list</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">      </span><span class="nx">page</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">      </span><span class="nx">hasMore</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">loadData</span><span class="p">()</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">stopPullDownRefresh</span><span class="p">()</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id8">
<h2>3. å›¾ç‰‡ä¼˜åŒ–<a class="headerlink" href="#id8" title="Permalink to this heading">ïƒ</a></h2>
<section id="id9">
<h3>3.1 å›¾ç‰‡æ‡’åŠ è½½<a class="headerlink" href="#id9" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- pages/list/list.wxml --&gt;</span>
<span class="p">&lt;</span><span class="nt">scroll-view</span> <span class="na">scroll-y</span> <span class="na">bindscroll</span><span class="o">=</span><span class="s">&quot;onScroll&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">view</span> <span class="na">wx:for</span><span class="o">=</span><span class="s">&quot;{{list}}&quot;</span> <span class="na">wx:key</span><span class="o">=</span><span class="s">&quot;id&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">image</span> 
      <span class="na">src</span><span class="o">=</span><span class="s">&quot;{{item.visible ? item.image : placeholderImage}}&quot;</span>
      <span class="na">lazy-load</span>
      <span class="na">mode</span><span class="o">=</span><span class="s">&quot;aspectFill&quot;</span>
    <span class="p">&gt;&lt;/</span><span class="nt">image</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">view</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">scroll-view</span><span class="p">&gt;</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Page</span><span class="p">({</span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">list</span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">    </span><span class="nx">placeholderImage</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;/images/placeholder.png&#39;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">onScroll</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">scrollTop</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">detail</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">viewportHeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">getSystemInfoSync</span><span class="p">().</span><span class="nx">windowHeight</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// è®¡ç®—å“ªäº›å›¾ç‰‡åº”è¯¥åŠ è½½</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">item</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">itemTop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">200</span><span class="w">  </span><span class="c1">// å‡è®¾æ¯é¡¹é«˜åº¦200rpx</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">itemBottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">itemTop</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">200</span>
<span class="w">      </span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">itemTop</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">scrollTop</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">viewportHeight</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">itemBottom</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">scrollTop</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
<span class="w">          </span><span class="p">[</span><span class="sb">`list[</span><span class="si">${</span><span class="nx">index</span><span class="si">}</span><span class="sb">].visible`</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id10">
<h3>3.2 å›¾ç‰‡é¢„åŠ è½½<a class="headerlink" href="#id10" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Page</span><span class="p">({</span>
<span class="w">  </span><span class="nx">preloadImages</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">images</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s1">&#39;https://example.com/image1.jpg&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;https://example.com/image2.jpg&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;https://example.com/image3.jpg&#39;</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">images</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">src</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">wx</span><span class="p">.</span><span class="nx">getImageInfo</span><span class="p">({</span><span class="w"> </span><span class="nx">src</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id11">
<h3>3.3 å›¾ç‰‡å‹ç¼©<a class="headerlink" href="#id11" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Page</span><span class="p">({</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">compressImage</span><span class="p">(</span><span class="nx">filePath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">compressImage</span><span class="p">({</span>
<span class="w">      </span><span class="nx">src</span><span class="o">:</span><span class="w"> </span><span class="nx">filePath</span><span class="p">,</span>
<span class="w">      </span><span class="nx">quality</span><span class="o">:</span><span class="w"> </span><span class="mf">80</span><span class="w">  </span><span class="c1">// å‹ç¼©è´¨é‡ 0-100</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">tempFilePath</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">chooseAndCompress</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">chooseRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">chooseImage</span><span class="p">({</span>
<span class="w">      </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">      </span><span class="nx">sizeType</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;compressed&#39;</span><span class="p">]</span><span class="w">  </span><span class="c1">// é€‰æ‹©å‹ç¼©å›¾</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">compressedPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">compressImage</span><span class="p">(</span><span class="nx">chooseRes</span><span class="p">.</span><span class="nx">tempFilePaths</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// ä¸Šä¼ å‹ç¼©åçš„å›¾ç‰‡</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">uploadImage</span><span class="p">(</span><span class="nx">compressedPath</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id12">
<h2>4. åˆ†åŒ…åŠ è½½<a class="headerlink" href="#id12" title="Permalink to this heading">ïƒ</a></h2>
<section id="id13">
<h3>4.1 åˆ†åŒ…é…ç½®<a class="headerlink" href="#id13" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="c1">// app.json</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;pages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;pages/index/index&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;pages/logs/logs&quot;</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;subPackages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;root&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;packageA&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;å•†åŸ&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;pages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;pages/products/products&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;pages/detail/detail&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;pages/cart/cart&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;root&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;packageB&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ä¸ªäººä¸­å¿ƒ&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;pages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;pages/profile/profile&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;pages/orders/orders&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;pages/settings/settings&quot;</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;independent&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">  </span><span class="c1">// ç‹¬ç«‹åˆ†åŒ…</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;preloadRule&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;pages/index/index&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;network&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;packages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;packageA&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id14">
<h3>4.2 åˆ†åŒ…è·³è½¬<a class="headerlink" href="#id14" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// è·³è½¬åˆ°åˆ†åŒ…é¡µé¢</span>
<span class="nx">wx</span><span class="p">.</span><span class="nx">navigateTo</span><span class="p">({</span>
<span class="w">  </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;/packageA/pages/products/products&#39;</span>
<span class="p">})</span>

<span class="c1">// é¢„ä¸‹è½½åˆ†åŒ…</span>
<span class="nx">wx</span><span class="p">.</span><span class="nx">preloadSubpackage</span><span class="p">({</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;packageA&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">success</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;åˆ†åŒ…é¢„ä¸‹è½½æˆåŠŸ&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id15">
<h2>5. ç¼“å­˜ç­–ç•¥<a class="headerlink" href="#id15" title="Permalink to this heading">ïƒ</a></h2>
<section id="id16">
<h3>5.1 æ•°æ®ç¼“å­˜<a class="headerlink" href="#id16" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// utils/cache.js</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">CACHE_EXPIRE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1000</span><span class="w">  </span><span class="c1">// 5åˆ†é’Ÿ</span>

<span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">cache</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">expire</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">CACHE_EXPIRE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">value</span><span class="p">,</span>
<span class="w">      </span><span class="nx">expire</span><span class="o">:</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">expire</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">setStorageSync</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">getStorageSync</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">expire</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">wx</span><span class="p">.</span><span class="nx">removeStorageSync</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">value</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">remove</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">removeStorageSync</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">clear</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">clearStorageSync</span><span class="p">()</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ä½¿ç”¨</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">cache</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;../../utils/cache.js&#39;</span>

<span class="nx">Page</span><span class="p">({</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">loadData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// å…ˆä»ç¼“å­˜è¯»å–</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cache</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// ç¼“å­˜ä¸å­˜åœ¨ï¼Œè¯·æ±‚æ¥å£</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
<span class="w">        </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://api.example.com/products&#39;</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span>
<span class="w">      </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span>
<span class="w">      </span>
<span class="w">      </span><span class="c1">// å­˜å…¥ç¼“å­˜</span>
<span class="w">      </span><span class="nx">cache</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">products</span><span class="o">:</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="p">})</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id17">
<h3>5.2 å›¾ç‰‡ç¼“å­˜<a class="headerlink" href="#id17" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// å°ç¨‹åºä¼šè‡ªåŠ¨ç¼“å­˜å›¾ç‰‡</span>
<span class="c1">// ä½¿ç”¨ç›¸åŒçš„URLä¼šä»ç¼“å­˜è¯»å–</span>

<span class="c1">// æ¸…é™¤å›¾ç‰‡ç¼“å­˜</span>
<span class="nx">wx</span><span class="p">.</span><span class="nx">removeImageCache</span><span class="p">({</span>
<span class="w">  </span><span class="nx">success</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;å›¾ç‰‡ç¼“å­˜å·²æ¸…é™¤&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id18">
<h2>6. ä»£ç ä¼˜åŒ–<a class="headerlink" href="#id18" title="Permalink to this heading">ïƒ</a></h2>
<section id="id19">
<h3>6.1 å‡å°‘åŒ…ä½“ç§¯<a class="headerlink" href="#id19" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>1. æ¸…ç†æ— ç”¨ä»£ç </strong>ï¼š</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># ä½¿ç”¨æ„å»ºå·¥å…·</span>
npm<span class="w"> </span>run<span class="w"> </span>build

<span class="c1"># å‹ç¼©å›¾ç‰‡</span>
tinypngã€imagemin
</pre></div>
</div>
<p><strong>2. ä½¿ç”¨npmåŒ…</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// æŒ‰éœ€å¼•å…¥</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">formatTime</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;miniprogram-date-utils&#39;</span>

<span class="c1">// è€Œä¸æ˜¯</span>
<span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">utils</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;utils&#39;</span>
</pre></div>
</div>
<p><strong>3. ä»£ç åˆ†ç¦»</strong>ï¼š</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// å°†å…¬å…±ä»£ç æŠ½ç¦»åˆ°utils</span>
<span class="c1">// utils/format.js</span>
<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">formatPrice</span><span class="p">(</span><span class="nx">price</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Â¥&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">price</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">100</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id20">
<h3>6.2 é¿å…ä¸å¿…è¦çš„æ¸²æŸ“<a class="headerlink" href="#id20" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- âŒ é”™è¯¯ï¼šwx:ifé¢‘ç¹åˆ‡æ¢ --&gt;</span>
<span class="p">&lt;</span><span class="nt">view</span> <span class="na">wx:if</span><span class="o">=</span><span class="s">&quot;{{show}}&quot;</span><span class="p">&gt;</span>å†…å®¹<span class="p">&lt;/</span><span class="nt">view</span><span class="p">&gt;</span>

<span class="cm">&lt;!-- âœ… æ­£ç¡®ï¼šhiddenåˆ‡æ¢ --&gt;</span>
<span class="p">&lt;</span><span class="nt">view</span> <span class="na">hidden</span><span class="o">=</span><span class="s">&quot;{{!show}}&quot;</span><span class="p">&gt;</span>å†…å®¹<span class="p">&lt;/</span><span class="nt">view</span><span class="p">&gt;</span>

<span class="cm">&lt;!-- è¯´æ˜ï¼š</span>
<span class="cm">  wx:if: æ¡ä»¶ä¸ºfalseæ—¶ä¸æ¸²æŸ“ï¼Œé€‚åˆä¸é¢‘ç¹åˆ‡æ¢</span>
<span class="cm">  hidden: å§‹ç»ˆæ¸²æŸ“ï¼Œåªæ˜¯éšè—ï¼Œé€‚åˆé¢‘ç¹åˆ‡æ¢</span>
<span class="cm">--&gt;</span>
</pre></div>
</div>
</section>
<section id="id21">
<h3>6.3 ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶<a class="headerlink" href="#id21" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// components/product-item/product-item.js</span>
<span class="nx">Component</span><span class="p">({</span>
<span class="w">  </span><span class="nx">properties</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">product</span><span class="o">:</span><span class="w"> </span><span class="nb">Object</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">methods</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">onTap</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">triggerEvent</span><span class="p">(</span><span class="s1">&#39;tap&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- pages/list/list.wxml --&gt;</span>
<span class="p">&lt;</span><span class="nt">product-item</span> 
  <span class="na">wx:for</span><span class="o">=</span><span class="s">&quot;{{products}}&quot;</span> 
  <span class="na">wx:key</span><span class="o">=</span><span class="s">&quot;id&quot;</span>
  <span class="na">product</span><span class="o">=</span><span class="s">&quot;{{item}}&quot;</span>
  <span class="na">bind:tap</span><span class="o">=</span><span class="s">&quot;onProductTap&quot;</span>
<span class="p">&gt;&lt;/</span><span class="nt">product-item</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id22">
<h2>7. æ€§èƒ½ç›‘æ§<a class="headerlink" href="#id22" title="Permalink to this heading">ïƒ</a></h2>
<section id="id23">
<h3>7.1 æ€§èƒ½æ•°æ®ä¸ŠæŠ¥<a class="headerlink" href="#id23" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// app.js</span>
<span class="nx">App</span><span class="p">({</span>
<span class="w">  </span><span class="nx">onLaunch</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// è·å–æ€§èƒ½æ•°æ®</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">performance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">getPerformance</span><span class="p">()</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// ç›‘å¬æ€§èƒ½æ•°æ®</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">observer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">performance</span><span class="p">.</span><span class="nx">createObserver</span><span class="p">((</span><span class="nx">entryList</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;æ€§èƒ½æ•°æ®&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">entryList</span><span class="p">.</span><span class="nx">getEntries</span><span class="p">())</span>
<span class="w">      </span>
<span class="w">      </span><span class="c1">// ä¸ŠæŠ¥åˆ°åç«¯</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">reportPerformance</span><span class="p">(</span><span class="nx">entryList</span><span class="p">.</span><span class="nx">getEntries</span><span class="p">())</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span>
<span class="w">    </span><span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">({</span><span class="w"> </span><span class="nx">entryTypes</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;navigation&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;render&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;script&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">})</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span>
<span class="w">  </span><span class="nx">reportPerformance</span><span class="p">(</span><span class="nx">entries</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
<span class="w">      </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://api.example.com/performance&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">entries</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id24">
<h3>7.2 ä½“éªŒè¯„åˆ†<a class="headerlink" href="#id24" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// å°ç¨‹åºåå° â†’ è¿ç»´ä¸­å¿ƒ â†’ æ€§èƒ½ç›‘æ§</span>
<span class="c1">// å¯ä»¥çœ‹åˆ°ï¼š</span>
<span class="c1">// - å¯åŠ¨è€—æ—¶</span>
<span class="c1">// - é¡µé¢åˆ‡æ¢è€—æ—¶</span>
<span class="c1">// - é¦–å±æ¸²æŸ“æ—¶é—´</span>
<span class="c1">// - å†…å­˜å ç”¨</span>
<span class="c1">// - å¡é¡¿æ¬¡æ•°</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id25">
<h2>8. æœ€ä½³å®è·µ<a class="headerlink" href="#id25" title="Permalink to this heading">ïƒ</a></h2>
<section id="id26">
<h3>8.1 ä»£ç è§„èŒƒ<a class="headerlink" href="#id26" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// 1. ä½¿ç”¨ES6+è¯­æ³•</span>
<span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">list</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">data</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">newList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">list</span><span class="p">,</span><span class="w"> </span><span class="nx">newItem</span><span class="p">]</span>

<span class="c1">// 2. async/awaitæ›¿ä»£å›è°ƒ</span>
<span class="k">async</span><span class="w"> </span><span class="nx">loadData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span><span class="w"> </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;...&#39;</span><span class="w"> </span><span class="p">})</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span><span class="w"> </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="w"> </span><span class="p">})</span>
<span class="p">}</span>

<span class="c1">// 3. åˆç†çš„æ³¨é‡Š</span>
<span class="cm">/**</span>
<span class="cm"> * åŠ è½½å•†å“åˆ—è¡¨</span>
<span class="cm"> * @param {number} page é¡µç </span>
<span class="cm"> * @param {number} size æ¯é¡µæ•°é‡</span>
<span class="cm"> */</span>
<span class="k">async</span><span class="w"> </span><span class="nx">loadProducts</span><span class="p">(</span><span class="nx">page</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// 4. é”™è¯¯å¤„ç†</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">loadData</span><span class="p">()</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
<span class="w">  </span><span class="nx">wx</span><span class="p">.</span><span class="nx">showToast</span><span class="p">({</span>
<span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;åŠ è½½å¤±è´¥&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;none&#39;</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id27">
<h3>8.2 ç›®å½•ç»“æ„<a class="headerlink" href="#id27" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>miniprogram/
â”œâ”€â”€ pages/               # é¡µé¢
â”‚   â”œâ”€â”€ index/
â”‚   â”œâ”€â”€ detail/
â”‚   â””â”€â”€ profile/
â”œâ”€â”€ components/          # ç»„ä»¶
â”‚   â”œâ”€â”€ product-item/
â”‚   â””â”€â”€ user-card/
â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ request.js
â”‚   â”œâ”€â”€ cache.js
â”‚   â””â”€â”€ util.js
â”œâ”€â”€ api/                 # APIæ¥å£
â”‚   â”œâ”€â”€ product.js
â”‚   â””â”€â”€ user.js
â”œâ”€â”€ styles/              # å…¬å…±æ ·å¼
â”‚   â””â”€â”€ common.wxss
â”œâ”€â”€ images/              # å›¾ç‰‡èµ„æº
â””â”€â”€ config/              # é…ç½®æ–‡ä»¶
    â””â”€â”€ index.js
</pre></div>
</div>
</section>
<section id="id28">
<h3>8.3 ç”¨æˆ·ä½“éªŒ<a class="headerlink" href="#id28" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// 1. åŠ è½½æç¤º</span>
<span class="nx">wx</span><span class="p">.</span><span class="nx">showLoading</span><span class="p">({</span><span class="w"> </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;åŠ è½½ä¸­&#39;</span><span class="w"> </span><span class="p">})</span>
<span class="k">await</span><span class="w"> </span><span class="nx">loadData</span><span class="p">()</span>
<span class="nx">wx</span><span class="p">.</span><span class="nx">hideLoading</span><span class="p">()</span>

<span class="c1">// 3. é”™è¯¯æç¤º</span>
<span class="nx">wx</span><span class="p">.</span><span class="nx">showToast</span><span class="p">({</span>
<span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;æ“ä½œå¤±è´¥&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">duration</span><span class="o">:</span><span class="w"> </span><span class="mf">2000</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- 2. ç©ºçŠ¶æ€ --&gt;</span>
<span class="p">&lt;</span><span class="nt">view</span> <span class="na">wx:if</span><span class="o">=</span><span class="s">&quot;{{list.length === 0}}&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">text</span><span class="p">&gt;</span>æš‚æ— æ•°æ®<span class="p">&lt;/</span><span class="nt">text</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">view</span><span class="p">&gt;</span>

<span class="cm">&lt;!-- 4. éª¨æ¶å± --&gt;</span>
<span class="p">&lt;</span><span class="nt">view</span> <span class="na">wx:if</span><span class="o">=</span><span class="s">&quot;{{loading}}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;skeleton&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">view</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;skeleton-item&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">view</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">view</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;skeleton-item&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">view</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">view</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id29">
<h2>9. å¸¸è§é—®é¢˜<a class="headerlink" href="#id29" title="Permalink to this heading">ïƒ</a></h2>
<section id="q1">
<h3>Q1: å¦‚ä½•è°ƒè¯•æ€§èƒ½é—®é¢˜ï¼Ÿ<a class="headerlink" href="#q1" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<ol class="arabic simple">
<li><p>å¼€å‘è€…å·¥å…· â†’ è°ƒè¯•å™¨ â†’ Performance</p></li>
<li><p>æŸ¥çœ‹setDataè°ƒç”¨é¢‘ç‡å’Œæ•°æ®é‡</p></li>
<li><p>ä½¿ç”¨Traceå·¥å…·åˆ†æ</p></li>
</ol>
</section>
<section id="q2">
<h3>Q2: å¦‚ä½•ä¼˜åŒ–é¦–å±åŠ è½½é€Ÿåº¦ï¼Ÿ<a class="headerlink" href="#q2" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<ol class="arabic simple">
<li><p>å‡å°‘é¦–å±è¯·æ±‚æ•°é‡</p></li>
<li><p>ä½¿ç”¨éª¨æ¶å±</p></li>
<li><p>é¢„åŠ è½½å…³é”®èµ„æº</p></li>
<li><p>å¯ç”¨åˆ†åŒ…é¢„ä¸‹è½½</p></li>
</ol>
</section>
<section id="q3">
<h3>Q3: å¦‚ä½•å‡å°‘åŒ…ä½“ç§¯ï¼Ÿ<a class="headerlink" href="#q3" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<ol class="arabic simple">
<li><p>å‹ç¼©å›¾ç‰‡èµ„æº</p></li>
<li><p>ä½¿ç”¨åˆ†åŒ…åŠ è½½</p></li>
<li><p>æ¸…ç†æ— ç”¨ä»£ç </p></li>
<li><p>ä½¿ç”¨CDNå­˜å‚¨é™æ€èµ„æº</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="id30">
<h2>å‚è€ƒèµ„æº<a class="headerlink" href="#id30" title="Permalink to this heading">ïƒ</a></h2>
<ul class="simple">
<li><p>å°ç¨‹åºæ€§èƒ½ä¼˜åŒ–æŒ‡å—</p></li>
<li><p>å°ç¨‹åºä½“éªŒè¯„åˆ†è§„åˆ™</p></li>
<li><p>å¾®ä¿¡å°ç¨‹åºæœ€ä½³å®è·µ</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="02-network-request-and-cloud.html" class="btn btn-neutral float-left" title="ç½‘ç»œè¯·æ±‚ä¸äº‘å¼€å‘" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="04-deployment-and-release.html" class="btn btn-neutral float-right" title="éƒ¨ç½²ä¸å‘å¸ƒ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Code Dojo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>