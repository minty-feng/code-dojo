

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>02-Go基础语法 &mdash; Backend Tutorial 1.0.0 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f07cb45e" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=34088549"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/translations.js?v=beaddf03"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="03-Go并发编程" href="03-concurrency.html" />
    <link rel="prev" title="01-Go环境搭建" href="01-environment-setup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            Backend Tutorial
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Backend Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/index.html">C++ 教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Python 教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../java/index.html">Java 教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nodejs/index.html">Node.js 教程</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Golang 教程</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="README.html">Golang 开发</a></li>
<li class="toctree-l2"><a class="reference internal" href="01-environment-setup.html">01-Go环境搭建</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">02-Go基础语法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">数据类型</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">基本类型</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">类型零值</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">类型转换</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id5">变量声明</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">四种方式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">常量</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id8">基本语法</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">控制结构</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">函数</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">函数类型和闭包</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defer">defer延迟执行</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id13">数据结构</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id14">数组</a></li>
<li class="toctree-l4"><a class="reference internal" href="#slice">切片（slice）</a></li>
<li class="toctree-l4"><a class="reference internal" href="#map">映射（map）</a></li>
<li class="toctree-l4"><a class="reference internal" href="#struct">结构体（struct）</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id15">指针</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">接口</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">错误处理</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">并发基础</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#goroutine">goroutine</a></li>
<li class="toctree-l4"><a class="reference internal" href="#channel">channel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id20">包和可见性</a></li>
<li class="toctree-l3"><a class="reference internal" href="#init">init函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">类型系统</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id22">类型定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23">类型嵌入</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id24">常见陷阱</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">最佳实践</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="03-concurrency.html">03-Go并发编程</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-web-development.html">04-Go Web开发</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-microservices.html">05-Go微服务实践</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-performance.html">06-Go性能优化</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../rust/index.html">Rust 教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/index.html">Shell 教程</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Backend Tutorial</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Golang 教程</a></li>
      <li class="breadcrumb-item active">02-Go基础语法</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/go/02-basic-syntax.md.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="go">
<h1>02-Go基础语法<a class="headerlink" href="#go" title="Link to this heading"></a></h1>
<p>Go语法简洁，吸收C系语言优点，去除冗余特性。25个关键字，学习成本低。</p>
<section id="id1">
<h2>数据类型<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<section id="id2">
<h3>基本类型<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 整型</span>
<span class="kt">int8</span><span class="p">,</span><span class="w"> </span><span class="kt">int16</span><span class="p">,</span><span class="w"> </span><span class="kt">int32</span><span class="p">,</span><span class="w"> </span><span class="kt">int64</span>
<span class="kt">uint8</span><span class="p">,</span><span class="w"> </span><span class="kt">uint16</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32</span><span class="p">,</span><span class="w"> </span><span class="kt">uint64</span>
<span class="kt">int</span><span class="w">                    </span><span class="c1">// 32或64位（取决于平台）</span>
<span class="kt">uint</span><span class="w">                   </span><span class="c1">// 无符号int</span>
<span class="kt">byte</span><span class="w">                   </span><span class="c1">// uint8别名</span>
<span class="kt">rune</span><span class="w">                   </span><span class="c1">// int32别名，表示Unicode码点</span>

<span class="c1">// 浮点型</span>
<span class="kt">float32</span><span class="p">,</span><span class="w"> </span><span class="kt">float64</span>

<span class="c1">// 复数</span>
<span class="kt">complex64</span><span class="p">,</span><span class="w"> </span><span class="kt">complex128</span>

<span class="c1">// 布尔型</span>
<span class="kt">bool</span><span class="w">                   </span><span class="c1">// true或false</span>

<span class="c1">// 字符串</span>
<span class="kt">string</span><span class="w">                 </span><span class="c1">// UTF-8编码，不可变</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>类型零值<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<p>Go变量声明后自动初始化为零值（无未定义行为）。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="kt">int</span><span class="w">        </span><span class="c1">// 0</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="kt">float64</span><span class="w">    </span><span class="c1">// 0.0</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kt">bool</span><span class="w">       </span><span class="c1">// false</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="kt">string</span><span class="w">     </span><span class="c1">// &quot;&quot;（空字符串）</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">p</span><span class="w"> </span><span class="o">*</span><span class="kt">int</span><span class="w">       </span><span class="c1">// nil</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">slice</span><span class="w"> </span><span class="p">[]</span><span class="kt">int</span><span class="w">  </span><span class="c1">// nil</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="w">  </span><span class="c1">// nil</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">ch</span><span class="w"> </span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="w">  </span><span class="c1">// nil</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">fn</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w">    </span><span class="c1">// nil</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>类型转换<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 必须显式转换（无隐式转换）</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">42</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">float64</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">u</span><span class="w"> </span><span class="kt">uint</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">uint</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>

<span class="c1">// 字符串转换</span>
<span class="kn">import</span><span class="w"> </span><span class="s">&quot;strconv&quot;</span>

<span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">strconv</span><span class="p">.</span><span class="nx">Atoi</span><span class="p">(</span><span class="s">&quot;123&quot;</span><span class="p">)</span><span class="w">     </span><span class="c1">// 字符串→int</span>
<span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">strconv</span><span class="p">.</span><span class="nx">Itoa</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span><span class="w">            </span><span class="c1">// int→字符串</span>
<span class="nx">f</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">strconv</span><span class="p">.</span><span class="nx">ParseFloat</span><span class="p">(</span><span class="s">&quot;3.14&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">)</span>
<span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">strconv</span><span class="p">.</span><span class="nx">FormatFloat</span><span class="p">(</span><span class="mf">3.14</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;f&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="id5">
<h2>变量声明<a class="headerlink" href="#id5" title="Link to this heading"></a></h2>
<section id="id6">
<h3>四种方式<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 1. var声明</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">age</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">25</span>

<span class="c1">// 2. 类型推断</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="w">  </span><span class="c1">// 自动推断为string</span>

<span class="c1">// 3. 短变量声明（函数内）</span>
<span class="nx">name</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="w">     </span><span class="c1">// 最常用</span>
<span class="nx">age</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">25</span>

<span class="c1">// 4. 批量声明</span>
<span class="kd">var</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">name</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span>
<span class="w">    </span><span class="nx">age</span><span class="w">  </span><span class="kt">int</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="mi">25</span>
<span class="w">    </span><span class="nx">city</span><span class="w"> </span><span class="kt">string</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id7">
<h3>常量<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">Pi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">3.14159</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">MaxSize</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span>

<span class="c1">// 批量常量</span>
<span class="kd">const</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">Red</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="nx">Green</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="nx">Blue</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span>
<span class="p">)</span>

<span class="c1">// iota（自增）</span>
<span class="kd">const</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">_</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="kc">iota</span><span class="w">  </span><span class="c1">// 0，跳过</span>
<span class="w">    </span><span class="nx">KB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kc">iota</span><span class="p">)</span><span class="w">  </span><span class="c1">// 1024</span>
<span class="w">    </span><span class="nx">MB</span><span class="w">                      </span><span class="c1">// 1048576</span>
<span class="w">    </span><span class="nx">GB</span><span class="w">                      </span><span class="c1">// 1073741824</span>
<span class="p">)</span>

<span class="kd">const</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">Monday</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">iota</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c1">// 1</span>
<span class="w">    </span><span class="nx">Tuesday</span><span class="w">            </span><span class="c1">// 2</span>
<span class="w">    </span><span class="nx">Wednesday</span><span class="w">          </span><span class="c1">// 3</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="id8">
<h2>基本语法<a class="headerlink" href="#id8" title="Link to this heading"></a></h2>
<section id="id9">
<h3>控制结构<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// if（无需括号）</span>
<span class="k">if</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// if with初始化</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">doSomething</span><span class="p">();</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">err</span>
<span class="p">}</span>
<span class="c1">// err作用域仅在if块内</span>

<span class="c1">// switch（无需break，自动break）</span>
<span class="k">switch</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="p">{</span>
<span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span><span class="w">  </span><span class="c1">// 多个条件</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="k">default</span><span class="p">:</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// switch with初始化</span>
<span class="k">switch</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">doSomething</span><span class="p">();</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">{</span>
<span class="k">case</span><span class="w"> </span><span class="kc">nil</span><span class="p">:</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="k">default</span><span class="p">:</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">err</span>
<span class="p">}</span>

<span class="c1">// switch无表达式（替代if-else链）</span>
<span class="k">switch</span><span class="w"> </span><span class="p">{</span>
<span class="k">case</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="k">case</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="k">default</span><span class="p">:</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// fallthrough（显式穿透）</span>
<span class="k">switch</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="p">{</span>
<span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;one&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">fallthrough</span><span class="w">  </span><span class="c1">// 继续执行case 2</span>
<span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;two&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// for循环（唯一循环语句）</span>
<span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// while风格</span>
<span class="k">for</span><span class="w"> </span><span class="nx">condition</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// 无限循环</span>
<span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">    </span><span class="k">break</span>
<span class="p">}</span>

<span class="c1">// range遍历</span>
<span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">slice</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// i是索引，v是值</span>
<span class="p">}</span>

<span class="k">for</span><span class="w"> </span><span class="nx">k</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="kd">map</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// k是键，v是值</span>
<span class="p">}</span>

<span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">slice</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 仅索引</span>
<span class="p">}</span>

<span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">slice</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 忽略索引（_是空标识符）</span>
<span class="p">}</span>

<span class="c1">// 标签和goto（少用）</span>
<span class="nx">Loop</span><span class="p">:</span>
<span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">break</span><span class="w"> </span><span class="nx">Loop</span><span class="w">  </span><span class="c1">// 跳出外层循环</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id10">
<h2>函数<a class="headerlink" href="#id10" title="Link to this heading"></a></h2>
<section id="id11">
<h3>函数定义<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 基本函数</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">add</span><span class="p">(</span><span class="nx">a</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span>
<span class="p">}</span>

<span class="c1">// 简化参数</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">add</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span>
<span class="p">}</span>

<span class="c1">// 多返回值</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">swap</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span>
<span class="p">}</span>

<span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>

<span class="c1">// 命名返回值</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">divide</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;division by zero&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w">  </span><span class="c1">// 返回result和err的当前值</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">b</span>
<span class="w">    </span><span class="k">return</span>
<span class="p">}</span>

<span class="c1">// 可变参数</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">sum</span><span class="p">(</span><span class="nx">nums</span><span class="w"> </span><span class="o">...</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">num</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">nums</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">total</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">num</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">total</span>
<span class="p">}</span>

<span class="nx">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="nx">nums</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span>
<span class="nx">sum</span><span class="p">(</span><span class="nx">nums</span><span class="o">...</span><span class="p">)</span><span class="w">  </span><span class="c1">// 展开切片</span>
</pre></div>
</div>
</section>
<section id="id12">
<h3>函数类型和闭包<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 函数类型</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">Operation</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">apply</span><span class="p">(</span><span class="nx">op</span><span class="w"> </span><span class="nx">Operation</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">op</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">apply</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>

<span class="c1">// 闭包</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">counter</span><span class="p">()</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">count</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">count</span><span class="o">++</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">count</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">c</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">counter</span><span class="p">()</span>
<span class="nx">c</span><span class="p">()</span><span class="w">  </span><span class="c1">// 1</span>
<span class="nx">c</span><span class="p">()</span><span class="w">  </span><span class="c1">// 2</span>
</pre></div>
</div>
</section>
<section id="defer">
<h3>defer延迟执行<a class="headerlink" href="#defer" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// defer按LIFO顺序执行</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">example</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;3&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span>
<span class="p">}</span>
<span class="c1">// 输出：1 2 3</span>

<span class="c1">// 常用于资源清理</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">readFile</span><span class="p">()</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">f</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">os</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="s">&quot;file.txt&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">err</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="nx">f</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span><span class="w">  </span><span class="c1">// 函数返回前自动关闭</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// 读取文件</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// defer参数立即求值</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">deferTest</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w">  </span><span class="c1">// 立即求值：1</span>
<span class="w">    </span><span class="nx">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="c1">// 输出：1（不是2）</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id13">
<h2>数据结构<a class="headerlink" href="#id13" title="Link to this heading"></a></h2>
<section id="id14">
<h3>数组<a class="headerlink" href="#id14" title="Link to this heading"></a></h3>
<p>固定长度，值类型。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 声明</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="kt">int</span><span class="w">              </span><span class="c1">// [0, 0, 0, 0, 0]</span>
<span class="nx">arr</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="kt">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">}</span>
<span class="nx">arr</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="p">]</span><span class="kt">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w">    </span><span class="c1">// 自动计算长度</span>

<span class="c1">// 访问</span>
<span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="nb">len</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span><span class="w">  </span><span class="c1">// 5</span>

<span class="c1">// 数组是值类型</span>
<span class="nx">arr2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">arr</span><span class="w">  </span><span class="c1">// 复制整个数组</span>
</pre></div>
</div>
</section>
<section id="slice">
<h3>切片（slice）<a class="headerlink" href="#slice" title="Link to this heading"></a></h3>
<p>动态数组，引用类型，最常用。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 创建</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="p">[]</span><span class="kt">int</span><span class="w">                  </span><span class="c1">// nil切片</span>
<span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span>
<span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w">          </span><span class="c1">// 长度5，容量5</span>
<span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w">      </span><span class="c1">// 长度5，容量10</span>

<span class="c1">// 切片数组</span>
<span class="nx">arr</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="kt">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">}</span>
<span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="w">                </span><span class="c1">// [2, 3, 4]</span>
<span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">arr</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="w">                 </span><span class="c1">// [1, 2, 3]</span>
<span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="w">                 </span><span class="c1">// [3, 4, 5]</span>

<span class="c1">// 操作</span>
<span class="nx">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w">             </span><span class="c1">// 追加元素</span>
<span class="nx">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w">       </span><span class="c1">// 追加多个</span>
<span class="nx">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">s1</span><span class="p">,</span><span class="w"> </span><span class="nx">s2</span><span class="o">...</span><span class="p">)</span><span class="w">        </span><span class="c1">// 合并切片</span>
<span class="nb">copy</span><span class="p">(</span><span class="nx">dst</span><span class="p">,</span><span class="w"> </span><span class="nx">src</span><span class="p">)</span><span class="w">               </span><span class="c1">// 复制</span>
<span class="nb">len</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="w">                       </span><span class="c1">// 长度</span>
<span class="nb">cap</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="w">                       </span><span class="c1">// 容量</span>

<span class="c1">// 删除元素</span>
<span class="nx">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">s</span><span class="p">[:</span><span class="nx">i</span><span class="p">],</span><span class="w"> </span><span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="o">...</span><span class="p">)</span><span class="w">  </span><span class="c1">// 删除索引i</span>
<span class="nx">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">s</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w">               </span><span class="c1">// 删除最后一个</span>
<span class="nx">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="w">                      </span><span class="c1">// 删除第一个</span>
</pre></div>
</div>
</section>
<section id="map">
<h3>映射（map）<a class="headerlink" href="#map" title="Link to this heading"></a></h3>
<p>哈希表，引用类型。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 创建</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="w">         </span><span class="c1">// nil map（不能写入）</span>
<span class="nx">m</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">{}</span><span class="w">        </span><span class="c1">// 空map</span>
<span class="nx">m</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">)</span>
<span class="nx">m</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">{</span><span class="s">&quot;a&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">}</span>

<span class="c1">// 操作</span>
<span class="nx">m</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">value</span><span class="w">             </span><span class="c1">// 添加/更新</span>
<span class="nx">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">]</span><span class="w">            </span><span class="c1">// 读取</span>
<span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">]</span><span class="w">        </span><span class="c1">// 检查存在性</span>
<span class="k">if</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// key存在</span>
<span class="p">}</span>

<span class="nb">delete</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;key&quot;</span><span class="p">)</span><span class="w">             </span><span class="c1">// 删除</span>
<span class="nb">len</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span><span class="w">                       </span><span class="c1">// 元素个数</span>

<span class="c1">// 遍历（无序）</span>
<span class="k">for</span><span class="w"> </span><span class="nx">k</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">for</span><span class="w"> </span><span class="nx">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// 仅键</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="struct">
<h3>结构体（struct）<a class="headerlink" href="#struct" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 定义</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">Person</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="w"> </span><span class="kt">string</span>
<span class="w">    </span><span class="nx">Age</span><span class="w">  </span><span class="kt">int</span>
<span class="w">    </span><span class="nx">City</span><span class="w"> </span><span class="kt">string</span>
<span class="p">}</span>

<span class="c1">// 创建</span>
<span class="nx">p1</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">Person</span><span class="p">{</span><span class="s">&quot;Alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Beijing&quot;</span><span class="p">}</span>
<span class="nx">p2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">Person</span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">Age</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">}</span><span class="w">  </span><span class="c1">// 字段名初始化</span>
<span class="nx">p3</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">Person</span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Charlie&quot;</span><span class="p">}</span><span class="w">       </span><span class="c1">// 未指定字段为零值</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">p4</span><span class="w"> </span><span class="nx">Person</span><span class="w">                       </span><span class="c1">// 零值初始化</span>

<span class="c1">// 访问</span>
<span class="nx">p1</span><span class="p">.</span><span class="nx">Name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Alice2&quot;</span>
<span class="nx">age</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">p1</span><span class="p">.</span><span class="nx">Age</span>

<span class="c1">// 结构体指针</span>
<span class="nx">p</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">Person</span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">}</span>
<span class="nx">p</span><span class="p">.</span><span class="nx">Age</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">25</span><span class="w">  </span><span class="c1">// 自动解引用（无需p-&gt;Age）</span>

<span class="c1">// 匿名字段（嵌入）</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">Student</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Person</span><span class="w">        </span><span class="c1">// 匿名字段，继承Person的字段</span>
<span class="w">    </span><span class="nx">StudentID</span><span class="w"> </span><span class="kt">string</span>
<span class="p">}</span>

<span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">Student</span><span class="p">{</span><span class="nx">Person</span><span class="p">:</span><span class="w"> </span><span class="nx">Person</span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">},</span><span class="w"> </span><span class="nx">StudentID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;123&quot;</span><span class="p">}</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">Name</span><span class="w">  </span><span class="c1">// 直接访问Person.Name</span>

<span class="c1">// 标签（tag）</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">User</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;name&quot; db:&quot;user_name&quot;`</span>
<span class="w">    </span><span class="nx">Email</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;email&quot; validate:&quot;required,email&quot;`</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id15">
<h2>指针<a class="headerlink" href="#id15" title="Link to this heading"></a></h2>
<p>Go有指针但无指针运算，更安全。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 指针声明</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">p</span><span class="w"> </span><span class="o">*</span><span class="kt">int</span>
<span class="nx">p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">x</span><span class="w">  </span><span class="c1">// 取地址</span>

<span class="c1">// 解引用</span>
<span class="o">*</span><span class="nx">p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>

<span class="c1">// new分配内存</span>
<span class="nx">p</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">new</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w">  </span><span class="c1">// 返回*int，值为0</span>

<span class="c1">// 指针vs值</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">modifyValue</span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="w">  </span><span class="c1">// 不影响原变量</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">modifyPointer</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="o">*</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="nx">p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="w">  </span><span class="c1">// 修改原变量</span>
<span class="p">}</span>

<span class="nx">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span>
<span class="nx">modifyValue</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w">  </span><span class="c1">// 1</span>

<span class="nx">modifyPointer</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">x</span><span class="p">)</span>
<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w">  </span><span class="c1">// 100</span>
</pre></div>
</div>
</section>
<section id="id16">
<h2>方法<a class="headerlink" href="#id16" title="Link to this heading"></a></h2>
<p>Go无类，用方法为类型添加行为。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span><span class="w"> </span><span class="nx">Rectangle</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Width</span><span class="p">,</span><span class="w"> </span><span class="nx">Height</span><span class="w"> </span><span class="kt">float64</span>
<span class="p">}</span>

<span class="c1">// 值接收者</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="w"> </span><span class="nx">Rectangle</span><span class="p">)</span><span class="w"> </span><span class="nx">Area</span><span class="p">()</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">r</span><span class="p">.</span><span class="nx">Width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">r</span><span class="p">.</span><span class="nx">Height</span>
<span class="p">}</span>

<span class="c1">// 指针接收者（可修改）</span>
<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="w"> </span><span class="o">*</span><span class="nx">Rectangle</span><span class="p">)</span><span class="w"> </span><span class="nx">Scale</span><span class="p">(</span><span class="nx">factor</span><span class="w"> </span><span class="kt">float64</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">Width</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="nx">factor</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">Height</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="nx">factor</span>
<span class="p">}</span>

<span class="nx">r</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">Rectangle</span><span class="p">{</span><span class="nx">Width</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nx">Height</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">}</span>
<span class="nx">r</span><span class="p">.</span><span class="nx">Area</span><span class="p">()</span><span class="w">    </span><span class="c1">// 50</span>
<span class="nx">r</span><span class="p">.</span><span class="nx">Scale</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="c1">// Width=20, Height=10</span>

<span class="c1">// 任意类型都可定义方法</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">MyInt</span><span class="w"> </span><span class="kt">int</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="w"> </span><span class="nx">MyInt</span><span class="p">)</span><span class="w"> </span><span class="nx">IsEven</span><span class="p">()</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">m</span><span class="o">%</span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>
<span class="p">}</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="nx">MyInt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="nx">x</span><span class="p">.</span><span class="nx">IsEven</span><span class="p">()</span><span class="w">  </span><span class="c1">// true</span>
</pre></div>
</div>
<p><strong>选择：</strong> 需要修改或大对象用指针接收者，否则用值接收者。</p>
</section>
<section id="id17">
<h2>接口<a class="headerlink" href="#id17" title="Link to this heading"></a></h2>
<p>隐式实现，鸭子类型。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 接口定义</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">Reader</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Read</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">[]</span><span class="kt">byte</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">Writer</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Write</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">[]</span><span class="kt">byte</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// 组合接口</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">ReadWriter</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Reader</span>
<span class="w">    </span><span class="nx">Writer</span>
<span class="p">}</span>

<span class="c1">// 实现接口（无需显式声明）</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">File</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">f</span><span class="w"> </span><span class="o">*</span><span class="nx">File</span><span class="p">)</span><span class="w"> </span><span class="nx">Read</span><span class="p">(</span><span class="nx">p</span><span class="w"> </span><span class="p">[]</span><span class="kt">byte</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 实现Read，File就实现了Reader接口</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// 空接口（任意类型）</span>
<span class="kd">interface</span><span class="p">{}</span><span class="w">  </span><span class="c1">// 或 any（Go 1.18+）</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">Print</span><span class="p">(</span><span class="nx">v</span><span class="w"> </span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">Print</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="nx">Print</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)</span>
<span class="nx">Print</span><span class="p">([]</span><span class="kt">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">})</span>

<span class="c1">// 类型断言</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="kd">interface</span><span class="p">{}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;hello&quot;</span>
<span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">i</span><span class="p">.(</span><span class="kt">string</span><span class="p">)</span><span class="w">              </span><span class="c1">// &quot;hello&quot;</span>
<span class="nx">s</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">i</span><span class="p">.(</span><span class="kt">string</span><span class="p">)</span><span class="w">          </span><span class="c1">// &quot;hello&quot;, true（安全断言）</span>
<span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">i</span><span class="p">.(</span><span class="kt">int</span><span class="p">)</span><span class="w">             </span><span class="c1">// 0, false</span>

<span class="c1">// 类型switch</span>
<span class="k">switch</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">i</span><span class="p">.(</span><span class="kd">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="k">case</span><span class="w"> </span><span class="kt">int</span><span class="p">:</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;int: %d\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">)</span>
<span class="k">case</span><span class="w"> </span><span class="kt">string</span><span class="p">:</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;string: %s\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">)</span>
<span class="k">default</span><span class="p">:</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;unknown type\n&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id18">
<h2>错误处理<a class="headerlink" href="#id18" title="Link to this heading"></a></h2>
<p>Go使用多返回值处理错误，无异常机制。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="s">&quot;errors&quot;</span>

<span class="c1">// 返回错误</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">divide</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;division by zero&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// 使用</span>
<span class="nx">result</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">divide</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w">  </span><span class="c1">// 处理错误</span>
<span class="p">}</span>

<span class="c1">// 自定义错误</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">MyError</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Code</span><span class="w">    </span><span class="kt">int</span>
<span class="w">    </span><span class="nx">Message</span><span class="w"> </span><span class="kt">string</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="o">*</span><span class="nx">MyError</span><span class="p">)</span><span class="w"> </span><span class="nx">Error</span><span class="p">()</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;code %d: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">Code</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">Message</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// errors.Is（Go 1.13+）</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">ErrNotFound</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;not found&quot;</span><span class="p">)</span>

<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">Is</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">ErrNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 错误匹配</span>
<span class="p">}</span>

<span class="c1">// errors.As（类型转换）</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">myErr</span><span class="w"> </span><span class="o">*</span><span class="nx">MyError</span>
<span class="k">if</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">As</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">myErr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">myErr</span><span class="p">.</span><span class="nx">Code</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// 错误包装</span>
<span class="k">return</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;failed to process: %w&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id19">
<h2>并发基础<a class="headerlink" href="#id19" title="Link to this heading"></a></h2>
<section id="goroutine">
<h3>goroutine<a class="headerlink" href="#goroutine" title="Link to this heading"></a></h3>
<p>轻量级线程，栈初始2KB，可创建百万级。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 启动goroutine</span>
<span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;goroutine&quot;</span><span class="p">)</span>
<span class="p">}()</span>

<span class="k">go</span><span class="w"> </span><span class="nx">processData</span><span class="p">()</span>

<span class="c1">// 匿名函数闭包</span>
<span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// 参数传递，避免闭包陷阱</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span>
<span class="w">    </span><span class="p">}(</span><span class="nx">i</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// 等待goroutine（用sync.WaitGroup）</span>
<span class="kn">import</span><span class="w"> </span><span class="s">&quot;sync&quot;</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">wg</span><span class="w"> </span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span>

<span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">wg</span><span class="p">.</span><span class="nx">Add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">defer</span><span class="w"> </span><span class="nx">wg</span><span class="p">.</span><span class="nx">Done</span><span class="p">()</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span>
<span class="w">    </span><span class="p">}(</span><span class="nx">i</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">wg</span><span class="p">.</span><span class="nx">Wait</span><span class="p">()</span><span class="w">  </span><span class="c1">// 等待所有goroutine完成</span>
</pre></div>
</div>
</section>
<section id="channel">
<h3>channel<a class="headerlink" href="#channel" title="Link to this heading"></a></h3>
<p>goroutine间通信，类型安全的管道。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 创建channel</span>
<span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w">       </span><span class="c1">// 无缓冲</span>
<span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w">   </span><span class="c1">// 缓冲大小10</span>

<span class="c1">// 发送和接收</span>
<span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">42</span><span class="w">      </span><span class="c1">// 发送</span>
<span class="nx">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch</span><span class="w"> </span><span class="c1">// 接收</span>

<span class="c1">// 关闭channel</span>
<span class="nb">close</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span>

<span class="c1">// 接收检查关闭</span>
<span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch</span>
<span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// channel已关闭</span>
<span class="p">}</span>

<span class="c1">// range遍历（直到关闭）</span>
<span class="k">for</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">ch</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// select多路复用</span>
<span class="k">select</span><span class="w"> </span><span class="p">{</span>
<span class="k">case</span><span class="w"> </span><span class="nx">msg1</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch1</span><span class="p">:</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;ch1:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">msg1</span><span class="p">)</span>
<span class="k">case</span><span class="w"> </span><span class="nx">msg2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch2</span><span class="p">:</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;ch2:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">msg2</span><span class="p">)</span>
<span class="k">case</span><span class="w"> </span><span class="nx">ch3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">value</span><span class="p">:</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;sent to ch3&quot;</span><span class="p">)</span>
<span class="k">case</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">time</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">):</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;timeout&quot;</span><span class="p">)</span>
<span class="k">default</span><span class="p">:</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;no communication&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id20">
<h2>包和可见性<a class="headerlink" href="#id20" title="Link to this heading"></a></h2>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 包声明（每个文件）</span>
<span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="c1">// 导入</span>
<span class="kn">import</span><span class="w"> </span><span class="s">&quot;fmt&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;os&quot;</span>
<span class="p">)</span>

<span class="c1">// 别名</span>
<span class="kn">import</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="s">&quot;fmt&quot;</span>
<span class="nx">f</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)</span>

<span class="c1">// 点导入（不推荐）</span>
<span class="kn">import</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="s">&quot;fmt&quot;</span>
<span class="nx">Println</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// 直接使用</span>

<span class="c1">// 仅初始化</span>
<span class="kn">import</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="s">&quot;image/png&quot;</span><span class="w">  </span><span class="c1">// 执行init函数</span>

<span class="c1">// 可见性：大写=导出（public），小写=未导出（private）</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">PublicStruct</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ExportedField</span><span class="w">   </span><span class="kt">int</span><span class="w">   </span><span class="c1">// 导出</span>
<span class="w">    </span><span class="nx">unexportedField</span><span class="w"> </span><span class="kt">int</span><span class="w">   </span><span class="c1">// 未导出</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="init">
<h2>init函数<a class="headerlink" href="#init" title="Link to this heading"></a></h2>
<p>包初始化时自动执行，可有多个。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="nx">Config</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 包初始化</span>
<span class="w">    </span><span class="nx">loadConfig</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 可以有多个init</span>
<span class="w">    </span><span class="nx">setupDatabase</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">// 执行顺序：</span>
<span class="c1">// 1. 导入包的init</span>
<span class="c1">// 2. 当前包变量初始化</span>
<span class="c1">// 3. 当前包init</span>
<span class="c1">// 4. main函数</span>
</pre></div>
</div>
</section>
<section id="id21">
<h2>类型系统<a class="headerlink" href="#id21" title="Link to this heading"></a></h2>
<section id="id22">
<h3>类型定义<a class="headerlink" href="#id22" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// type定义新类型</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">MyInt</span><span class="w"> </span><span class="kt">int</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="nx">MyInt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="c1">// x = y  // 错误！不同类型</span>

<span class="c1">// type别名（Go 1.9+）</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">MyInt2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kt">int</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">MyInt2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span>
<span class="nx">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">b</span><span class="w">  </span><span class="c1">// OK，相同类型</span>
</pre></div>
</div>
</section>
<section id="id23">
<h3>类型嵌入<a class="headerlink" href="#id23" title="Link to this heading"></a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 嵌入结构体</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">Engine</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Power</span><span class="w"> </span><span class="kt">int</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="o">*</span><span class="nx">Engine</span><span class="p">)</span><span class="w"> </span><span class="nx">Start</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Engine started&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">Car</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Engine</span><span class="w">        </span><span class="c1">// 嵌入，继承Engine的字段和方法</span>
<span class="w">    </span><span class="nx">Brand</span><span class="w"> </span><span class="kt">string</span>
<span class="p">}</span>

<span class="nx">car</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">Car</span><span class="p">{</span><span class="nx">Engine</span><span class="p">:</span><span class="w"> </span><span class="nx">Engine</span><span class="p">{</span><span class="nx">Power</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">},</span><span class="w"> </span><span class="nx">Brand</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Toyota&quot;</span><span class="p">}</span>
<span class="nx">car</span><span class="p">.</span><span class="nx">Power</span><span class="w">       </span><span class="c1">// 200（提升字段）</span>
<span class="nx">car</span><span class="p">.</span><span class="nx">Start</span><span class="p">()</span><span class="w">     </span><span class="c1">// &quot;Engine started&quot;（提升方法）</span>

<span class="c1">// 嵌入接口</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">ReadWriter</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Reader</span>
<span class="w">    </span><span class="nx">Writer</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id24">
<h2>常见陷阱<a class="headerlink" href="#id24" title="Link to this heading"></a></h2>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// 1. range循环变量陷阱</span>
<span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">slice</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">)</span><span class="w">  </span><span class="c1">// 错误！闭包捕获变量，值可能变化</span>
<span class="w">    </span><span class="p">}()</span>
<span class="p">}</span>

<span class="c1">// 正确：传参</span>
<span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">slice</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">)</span>
<span class="w">    </span><span class="p">}(</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// 2. slice共享底层数组</span>
<span class="nx">arr</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">}</span>
<span class="nx">s1</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="w">  </span><span class="c1">// [1, 2]</span>
<span class="nx">s2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="w">  </span><span class="c1">// [2, 3]</span>
<span class="nx">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">999</span><span class="w">     </span><span class="c1">// s2[0]也变成999（共享数组）</span>

<span class="c1">// 3. map并发读写panic</span>
<span class="nx">m</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">)</span>
<span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}()</span><span class="w">  </span><span class="c1">// 写</span>
<span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">m</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">}()</span><span class="w">  </span><span class="c1">// 读（panic！）</span>

<span class="c1">// 使用sync.Map或加锁</span>

<span class="c1">// 4. nil map不能写入</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="w">  </span><span class="c1">// nil</span>
<span class="c1">// m[&quot;key&quot;] = 1  // panic</span>
<span class="nx">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">int</span><span class="p">)</span><span class="w">  </span><span class="c1">// 必须初始化</span>

<span class="c1">// 5. slice作为函数参数</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">modify</span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="p">[]</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">999</span><span class="w">  </span><span class="c1">// 影响原slice（引用类型）</span>
<span class="w">    </span><span class="nx">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w">  </span><span class="c1">// 不影响原slice（可能重新分配）</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id25">
<h2>最佳实践<a class="headerlink" href="#id25" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>短变量声明</strong>：函数内优先用<code class="docutils literal notranslate"><span class="pre">:=</span></code></p></li>
<li><p><strong>错误处理</strong>：每个error都检查</p></li>
<li><p><strong>defer清理资源</strong>：文件、锁、连接</p></li>
<li><p><strong>指针接收者</strong>：修改对象或大对象</p></li>
<li><p><strong>命名返回值</strong>：复杂函数增强可读性</p></li>
<li><p><strong>channel通信</strong>：不要通过共享内存通信，通过通信共享内存</p></li>
<li><p><strong>select处理多channel</strong>：超时、取消、多路复用</p></li>
<li><p><strong>空接口慎用</strong>：丧失类型安全</p></li>
<li><p><strong>gofmt格式化</strong>：自动化，无争议</p></li>
<li><p><strong>接口小而专注</strong>：io.Reader只有一个方法</p></li>
</ol>
<p><strong>核心：</strong> Go追求简洁和并发，利用goroutine和channel构建高并发系统。</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="01-environment-setup.html" class="btn btn-neutral float-left" title="01-Go环境搭建" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="03-concurrency.html" class="btn btn-neutral float-right" title="03-Go并发编程" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2025, Code Dojo。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>